var ie=Object.defineProperty;var Ut=i=>{throw TypeError(i)};var ne=(i,t,e)=>t in i?ie(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var d=(i,t,e)=>ne(i,typeof t!="symbol"?t+"":t,e),xt=(i,t,e)=>t.has(i)||Ut("Cannot "+e);var v=(i,t,e)=>(xt(i,t,"read from private field"),e?e.call(i):t.get(i)),H=(i,t,e)=>t.has(i)?Ut("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),x=(i,t,e,r)=>(xt(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e),b=(i,t,e)=>(xt(i,t,"access private method"),e);class Nt{constructor(t){d(this,"icaltype","binary");this.value=t}static fromString(t){return new Nt(t)}decodeValue(){return this._b64_decode(this.value)}setEncodedValue(t){this.value=this._b64_encode(t)}_b64_encode(t){let e,r,n,s,a,o,l,u,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,f=0,g="",D=[];if(!t)return t;do e=t.charCodeAt(c++),r=t.charCodeAt(c++),n=t.charCodeAt(c++),u=e<<16|r<<8|n,s=u>>18&63,a=u>>12&63,o=u>>6&63,l=63&u,D[f++]=h.charAt(s)+h.charAt(a)+h.charAt(o)+h.charAt(l);while(c<t.length);g=D.join("");let p=t.length%3;return(p?g.slice(0,p-3):g)+"===".slice(p||3)}_b64_decode(t){let e,r,n,s,a,o,l,u,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,f=0,g="",D=[];if(!t)return t;t+="";do s=h.indexOf(t.charAt(c++)),a=h.indexOf(t.charAt(c++)),o=h.indexOf(t.charAt(c++)),l=h.indexOf(t.charAt(c++)),u=s<<18|a<<12|o<<6|l,e=u>>16&255,r=u>>8&255,n=255&u,D[f++]=o==64?String.fromCharCode(e):l==64?String.fromCharCode(e,r):String.fromCharCode(e,r,n);while(c<t.length);return g=D.join(""),g}toString(){return this.value}}const se=/([PDWHMTS]{1,1})/,ae=["weeks","days","hours","minutes","seconds","isNegative"];class M{constructor(t){d(this,"weeks",0);d(this,"days",0);d(this,"hours",0);d(this,"minutes",0);d(this,"seconds",0);d(this,"isNegative",!1);d(this,"icalclass","icalduration");d(this,"icaltype","duration");this.wrappedJSObject=this,this.fromData(t)}static fromSeconds(t){return new M().fromSeconds(t)}static isValueString(t){return t[0]==="P"||t[1]==="P"}static fromString(t){let e=0,r=Object.create(null),n=0;for(;(e=t.search(se))!==-1;){let s=t[e],a=t.slice(0,Math.max(0,e));t=t.slice(e+1),n+=oe(s,a,r)}if(n<2)throw new Error('invalid duration value: Not enough duration components in "'+t+'"');return new M(r)}static fromData(t){return new M(t)}clone(){return M.fromData(this)}toSeconds(){let t=this.seconds+60*this.minutes+3600*this.hours+86400*this.days+604800*this.weeks;return this.isNegative?-t:t}fromSeconds(t){let e=Math.abs(t);return this.isNegative=t<0,this.days=C(e/86400),this.days%7==0?(this.weeks=this.days/7,this.days=0):this.weeks=0,e-=86400*(this.days+7*this.weeks),this.hours=C(e/3600),e-=3600*this.hours,this.minutes=C(e/60),e-=60*this.minutes,this.seconds=e,this}fromData(t){for(let e of ae)this[e]=t&&e in t?t[e]:0}reset(){this.isNegative=!1,this.weeks=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0}compare(t){let e=this.toSeconds(),r=t.toSeconds();return(e>r)-(e<r)}normalize(){this.fromSeconds(this.toSeconds())}toString(){if(this.toSeconds()==0)return"PT0S";{let t="";return this.isNegative&&(t+="-"),t+="P",this.weeks&&(t+=this.weeks+"W"),this.days&&(t+=this.days+"D"),(this.hours||this.minutes||this.seconds)&&(t+="T",this.hours&&(t+=this.hours+"H"),this.minutes&&(t+=this.minutes+"M"),this.seconds&&(t+=this.seconds+"S")),t}}toICALString(){return this.toString()}}function oe(i,t,e){let r;switch(i){case"P":e.isNegative=!(!t||t!=="-");break;case"D":r="days";break;case"W":r="weeks";break;case"H":r="hours";break;case"M":r="minutes";break;case"S":r="seconds";break;default:return 0}if(r){if(!t&&t!==0)throw new Error('invalid duration value: Missing number before "'+i+'"');let n=parseInt(t,10);if(gt(n))throw new Error('invalid duration value: Invalid number "'+t+'" before "'+i+'"');e[r]=n}return 1}var ut;const m=class m{constructor(t,e){d(this,"icalclass","icaltime");d(this,"_cachedUnixTime",null);d(this,"zone",null);d(this,"_pendingNormalization",!1);this.wrappedJSObject=this;let r=this._time=Object.create(null);r.year=0,r.month=1,r.day=1,r.hour=0,r.minute=0,r.second=0,r.isDate=!1,this.fromData(t,e)}static daysInMonth(t,e){let r=30;return t<1||t>12||(r=[0,31,28,31,30,31,30,31,31,30,31,30,31][t],t==2&&(r+=m.isLeapYear(e))),r}static isLeapYear(t){return t<=1752?t%4==0:t%4==0&&t%100!=0||t%400==0}static fromDayOfYear(t,e){let r=e,n=t,s=new m;s.auto_normalize=!1;let a=m.isLeapYear(r)?1:0;if(n<1)return r--,a=m.isLeapYear(r)?1:0,n+=m.daysInYearPassedMonth[a][12],m.fromDayOfYear(n,r);if(n>m.daysInYearPassedMonth[a][12])return a=m.isLeapYear(r)?1:0,n-=m.daysInYearPassedMonth[a][12],r++,m.fromDayOfYear(n,r);s.year=r,s.isDate=!0;for(let o=11;o>=0;o--)if(n>m.daysInYearPassedMonth[a][o]){s.month=o+1,s.day=n-m.daysInYearPassedMonth[a][o];break}return s.auto_normalize=!0,s}static fromStringv2(t){return new m({year:parseInt(t.slice(0,4),10),month:parseInt(t.slice(5,7),10),day:parseInt(t.slice(8,10),10),isDate:!0})}static fromDateString(t){return new m({year:B(t.slice(0,4)),month:B(t.slice(5,7)),day:B(t.slice(8,10)),isDate:!0})}static fromDateTimeString(t,e){if(t.length<19)throw new Error('invalid date-time value: "'+t+'"');let r,n;t[19]&&t[19]==="Z"?r=O.utcTimezone:e&&(n=e.getParameter("tzid"),e.parent&&(e.parent.name==="standard"||e.parent.name==="daylight"?r=O.localTimezone:n&&(r=e.parent.getTimeZoneByID(n))));const s={year:B(t.slice(0,4)),month:B(t.slice(5,7)),day:B(t.slice(8,10)),hour:B(t.slice(11,13)),minute:B(t.slice(14,16)),second:B(t.slice(17,19))};return n&&!r&&(s.timezone=n),new m(s,r)}static fromString(t,e){return t.length>10?m.fromDateTimeString(t,e):m.fromDateString(t)}static fromJSDate(t,e){return new m().fromJSDate(t,e)}static now(){return m.fromJSDate(new Date,!1)}static weekOneStarts(t,e){let r=m.fromData({year:t,month:1,day:1,isDate:!0}),n=r.dayOfWeek(),s=e||m.DEFAULT_WEEK_START;return n>m.THURSDAY&&(r.day+=7),s>m.THURSDAY&&(r.day-=7),r.day-=n-s,r}static getDominicalLetter(t){let e="GFEDCBA",r=(t+(t/4|0)+(t/400|0)-(t/100|0)-1)%7;return m.isLeapYear(t)?e[(r+6)%7]+e[r]:e[r]}static get epochTime(){return v(this,ut)||x(this,ut,m.fromData({year:1970,month:1,day:1,hour:0,minute:0,second:0,isDate:!1,timezone:"Z"})),v(this,ut)}static _cmp_attr(t,e,r){return t[r]>e[r]?1:t[r]<e[r]?-1:0}get icaltype(){return this.isDate?"date":"date-time"}clone(){return new m(this._time,this.zone)}reset(){this.fromData(m.epochTime),this.zone=O.utcTimezone}resetTo(t,e,r,n,s,a,o){this.fromData({year:t,month:e,day:r,hour:n,minute:s,second:a,zone:o})}fromJSDate(t,e){return t?e?(this.zone=O.utcTimezone,this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()):(this.zone=O.localTimezone,this.year=t.getFullYear(),this.month=t.getMonth()+1,this.day=t.getDate(),this.hour=t.getHours(),this.minute=t.getMinutes(),this.second=t.getSeconds()):this.reset(),this._cachedUnixTime=null,this}fromData(t,e){if(t)for(let[r,n]of Object.entries(t))r!=="icaltype"&&(this[r]=n);if(e&&(this.zone=e),t&&!("isDate"in t)?this.isDate=!("hour"in t):t&&"isDate"in t&&(this.isDate=t.isDate),t&&"timezone"in t){let r=Et.get(t.timezone);this.zone=r||O.localTimezone}return t&&"zone"in t&&(this.zone=t.zone),this.zone||(this.zone=O.localTimezone),this._cachedUnixTime=null,this}dayOfWeek(t){let e=t||m.SUNDAY,r=(this.year<<12)+(this.month<<8)+(this.day<<3)+e;if(r in m._dowCache)return m._dowCache[r];let n=this.day,s=this.month+(this.month<3?12:0),a=this.year-(this.month<3?1:0),o=n+a+C(26*(s+1)/10)+C(a/4);return o+=6*C(a/100)+C(a/400),o=(o+7-e)%7+1,m._dowCache[r]=o,o}dayOfYear(){let t=m.isLeapYear(this.year)?1:0;return m.daysInYearPassedMonth[t][this.month-1]+this.day}startOfWeek(t){let e=t||m.SUNDAY,r=this.clone();return r.day-=(this.dayOfWeek()+7-e)%7,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r}endOfWeek(t){let e=t||m.SUNDAY,r=this.clone();return r.day+=(7-this.dayOfWeek()+e-m.SUNDAY)%7,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r}startOfMonth(){let t=this.clone();return t.day=1,t.isDate=!0,t.hour=0,t.minute=0,t.second=0,t}endOfMonth(){let t=this.clone();return t.day=m.daysInMonth(t.month,t.year),t.isDate=!0,t.hour=0,t.minute=0,t.second=0,t}startOfYear(){let t=this.clone();return t.day=1,t.month=1,t.isDate=!0,t.hour=0,t.minute=0,t.second=0,t}endOfYear(){let t=this.clone();return t.day=31,t.month=12,t.isDate=!0,t.hour=0,t.minute=0,t.second=0,t}startDoyWeek(t){let e=t||m.SUNDAY,r=this.dayOfWeek()-e;return r<0&&(r+=7),this.dayOfYear()-r}getDominicalLetter(){return m.getDominicalLetter(this.year)}nthWeekDay(t,e){let r,n=m.daysInMonth(this.month,this.year),s=e,a=0,o=this.clone();if(s>=0){o.day=1,s!=0&&s--,a=o.day;let l=t-o.dayOfWeek();l<0&&(l+=7),a+=l,a-=t,r=t}else o.day=n,s++,r=o.dayOfWeek()-t,r<0&&(r+=7),r=n-r;return r+=7*s,a+r}isNthWeekDay(t,e){let r=this.dayOfWeek();return e===0&&r===t||this.nthWeekDay(t,e)===this.day}weekNumber(t){let e,r=(this.year<<12)+(this.month<<8)+(this.day<<3)+t;if(r in m._wnCache)return m._wnCache[r];let n=this.clone();n.isDate=!0;let s=this.year;n.month==12&&n.day>25?(e=m.weekOneStarts(s+1,t),n.compare(e)<0?e=m.weekOneStarts(s,t):s++):(e=m.weekOneStarts(s,t),n.compare(e)<0&&(e=m.weekOneStarts(--s,t)));let a=C(n.subtractDate(e).toSeconds()/86400/7)+1;return m._wnCache[r]=a,a}addDuration(t){let e=t.isNegative?-1:1,r=this.second,n=this.minute,s=this.hour,a=this.day;r+=e*t.seconds,n+=e*t.minutes,s+=e*t.hours,a+=e*t.days,a+=7*e*t.weeks,this.second=r,this.minute=n,this.hour=s,this.day=a,this._cachedUnixTime=null}subtractDate(t){let e=this.toUnixTime()+this.utcOffset(),r=t.toUnixTime()+t.utcOffset();return M.fromSeconds(e-r)}subtractDateTz(t){let e=this.toUnixTime(),r=t.toUnixTime();return M.fromSeconds(e-r)}compare(t){let e=this.toUnixTime(),r=t.toUnixTime();return e>r?1:r>e?-1:0}compareDateOnlyTz(t,e){let r=this.convertToZone(e),n=t.convertToZone(e),s=0;return(s=m._cmp_attr(r,n,"year"))!=0||(s=m._cmp_attr(r,n,"month"))!=0||(s=m._cmp_attr(r,n,"day")),s}convertToZone(t){let e=this.clone(),r=this.zone.tzid==t.tzid;return this.isDate||r||O.convert_time(e,this.zone,t),e.zone=t,e}utcOffset(){return this.zone==O.localTimezone||this.zone==O.utcTimezone?0:this.zone.utcOffset(this)}toICALString(){let t=this.toString();return t.length>10?N.icalendar.value["date-time"].toICAL(t):N.icalendar.value.date.toICAL(t)}toString(){let t=this.year+"-"+U(this.month)+"-"+U(this.day);return this.isDate||(t+="T"+U(this.hour)+":"+U(this.minute)+":"+U(this.second),this.zone===O.utcTimezone&&(t+="Z")),t}toJSDate(){return this.zone==O.localTimezone?this.isDate?new Date(this.year,this.month-1,this.day):new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0):new Date(1e3*this.toUnixTime())}_normalize(){return this._time.isDate&&(this._time.hour=0,this._time.minute=0,this._time.second=0),this.adjust(0,0,0,0),this}adjust(t,e,r,n,s){let a,o,l,u,h,c,f,g=0,D=0,p=s||this._time;if(p.isDate||(l=p.second+n,p.second=l%60,a=C(l/60),p.second<0&&(p.second+=60,a--),u=p.minute+r+a,p.minute=u%60,o=C(u/60),p.minute<0&&(p.minute+=60,o--),h=p.hour+e+o,p.hour=h%24,g=C(h/24),p.hour<0&&(p.hour+=24,g--)),p.month>12?D=C((p.month-1)/12):p.month<1&&(D=C(p.month/12)-1),p.year+=D,p.month-=12*D,c=p.day+t+g,c>0)for(;f=m.daysInMonth(p.month,p.year),!(c<=f);)p.month++,p.month>12&&(p.year++,p.month=1),c-=f;else for(;c<=0;)p.month==1?(p.year--,p.month=12):p.month--,c+=m.daysInMonth(p.month,p.year);return p.day=c,this._cachedUnixTime=null,this}fromUnixTime(t){this.zone=O.utcTimezone;let e=new Date(1e3*t);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this._time.isDate?(this.hour=0,this.minute=0,this.second=0):(this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()),this._cachedUnixTime=null}toUnixTime(){if(this._cachedUnixTime!==null)return this._cachedUnixTime;let t=this.utcOffset(),e=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second-t);return this._cachedUnixTime=e/1e3,this._cachedUnixTime}toJSON(){let t,e=["year","month","day","hour","minute","second","isDate"],r=Object.create(null),n=0,s=e.length;for(;n<s;n++)t=e[n],r[t]=this[t];return this.zone&&(r.timezone=this.zone.tzid),r}};ut=new WeakMap,d(m,"_dowCache",{}),d(m,"_wnCache",{}),d(m,"fromData",function(t,e){return new m().fromData(t,e)}),H(m,ut,null),d(m,"daysInYearPassedMonth",[[0,31,59,90,120,151,181,212,243,273,304,334,365],[0,31,60,91,121,152,182,213,244,274,305,335,366]]),d(m,"SUNDAY",1),d(m,"MONDAY",2),d(m,"TUESDAY",3),d(m,"WEDNESDAY",4),d(m,"THURSDAY",5),d(m,"FRIDAY",6),d(m,"SATURDAY",7),d(m,"DEFAULT_WEEK_START",2);let y=m;(function(){function i(t){Object.defineProperty(y.prototype,t,{get:function(){return this._pendingNormalization&&(this._normalize(),this._pendingNormalization=!1),this._time[t]},set:function(e){t==="isDate"&&e&&!this._time.isDate&&this.adjust(0,0,0,0),this._cachedUnixTime=null,this._pendingNormalization=!0,this._time[t]=e}})}i("year"),i("month"),i("day"),i("hour"),i("minute"),i("second"),i("isDate")})();const le=/[^ \t]/,he={"^'":'"',"^n":`
`,"^^":"^"};function Y(i){let t={},e=t.component=[];if(t.stack=[e],Y._eachLine(i,function(r,n){Y._handleContentLine(n,t)}),t.stack.length>1)throw new et("invalid ical body. component began but did not end");return t=null,e.length==1?e[0]:e}Y.property=function(i,t){let e={component:[[],[]],designSet:t||N.defaultSet};return Y._handleContentLine(i,e),e.component[1][0]},Y.component=function(i){return Y(i)};class et extends Error{constructor(t){super(t),this.name=this.constructor.name;try{throw new Error}catch(e){if(e.stack){let r=e.stack.split(`
`);r.shift(),this.stack=r.join(`
`)}}}}Y.ParserError=et,Y._handleContentLine=function(i,t){let e,r,n,s,a,o,l=i.indexOf(":"),u=i.indexOf(";"),h={};if(u!==-1&&l!==-1&&u>l&&(u=-1),u!==-1){if(n=i.slice(0,Math.max(0,u)).toLowerCase(),a=Y._parseParameters(i.slice(Math.max(0,u)),0,t.designSet),a[2]==-1)throw new et("Invalid parameters in '"+i+"'");if(h=a[0],e=a[1].length+a[2]+u,(r=i.slice(Math.max(0,e)).indexOf(":"))===-1)throw new et("Missing parameter value in '"+i+"'");s=i.slice(Math.max(0,e+r+1))}else{if(l===-1)throw new et('invalid line (no token ";" or ":") "'+i+'"');if(n=i.slice(0,Math.max(0,l)).toLowerCase(),s=i.slice(Math.max(0,l+1)),n==="begin"){let w=[s.toLowerCase(),[],[]];return t.stack.length===1?t.component.push(w):t.component[2].push(w),t.stack.push(t.component),t.component=w,void(t.designSet||(t.designSet=N.getDesignSet(t.component[0])))}if(n==="end")return void(t.component=t.stack.pop())}let c,f,g,D,p=!1,E=!1;t.designSet.propertyGroups&&n.indexOf(".")!==-1?(f=n.split("."),h.group=f[0],g=f[1]):g=n,g in t.designSet.property&&(c=t.designSet.property[g],"multiValue"in c&&(p=c.multiValue),"structuredValue"in c&&(E=c.structuredValue),s&&"detectType"in c&&(o=c.detectType(s))),o||(o="value"in h?h.value.toLowerCase():c?c.defaultType:"unknown"),delete h.value,p&&E?(s=Y._parseMultiValue(s,E,o,[],p,t.designSet,E),D=[g,h,o,s]):p?(D=[g,h,o],Y._parseMultiValue(s,p,o,D,null,t.designSet,!1)):E?(s=Y._parseMultiValue(s,E,o,[],null,t.designSet,E),D=[g,h,o,s]):(s=Y._parseValue(s,o,t.designSet,!1),D=[g,h,o,s]),t.component[0]!=="vcard"||t.component[1].length!==0||n==="version"&&s==="4.0"||(t.designSet=N.getDesignSet("vcard3")),t.component[1].push(D)},Y._parseValue=function(i,t,e,r){return t in e.value&&"fromICAL"in e.value[t]?e.value[t].fromICAL(i,r):i},Y._parseParameters=function(i,t,e){let r,n,s,a,o,l,u=t,h=0,c={},f=-1;for(;h!==!1&&(h=W(i,"=",h+1))!==-1;){if(r=i.slice(u+1,h),r.length==0)throw new et("Empty parameter name in '"+i+"'");if(n=r.toLowerCase(),l=!1,o=!1,a=n in e.param&&e.param[n].valueType?e.param[n].valueType:"text",n in e.param&&(o=e.param[n].multiValue,e.param[n].multiValueSeparateDQuote&&(l=Y._rfc6868Escape('"'+o+'"'))),i[h+1]==='"'){if(f=h+2,h=W(i,'"',f),o&&h!=-1){let g=!0;for(;g;)i[h+1]==o&&i[h+2]=='"'?h=W(i,'"',h+3):g=!1}if(h===-1)throw new et('invalid line (no matching double quote) "'+i+'"');s=i.slice(f,h),u=W(i,";",h),u===-1&&(h=!1)}else{f=h+1;let g=W(i,";",f),D=W(i,":",f);D!==-1&&g>D?(g=D,h=!1):g===-1?(g=D===-1?i.length:D,h=!1):(u=g,h=g),s=i.slice(f,g)}if(s=Y._rfc6868Escape(s),o){let g=l||o;s=Y._parseMultiValue(s,g,a,[],null,e)}else s=Y._parseValue(s,a,e);o&&n in c?Array.isArray(c[n])?c[n].push(s):c[n]=[c[n],s]:c[n]=s}return[c,s,f]},Y._rfc6868Escape=function(i){return i.replace(/\^['n^]/g,function(t){return he[t]})},Y._parseMultiValue=function(i,t,e,r,n,s,a){let o,l=0,u=0;if(t.length===0)return i;for(;(l=W(i,t,u))!==-1;)o=i.slice(u,l),o=n?Y._parseMultiValue(o,n,e,[],null,s,a):Y._parseValue(o,e,s,a),r.push(o),u=l+t.length;return o=i.slice(u),o=n?Y._parseMultiValue(o,n,e,[],null,s,a):Y._parseValue(o,e,s,a),r.push(o),r.length==1?r[0]:r},Y._eachLine=function(i,t){let e,r,n,s=i.length,a=i.search(le),o=a;do o=i.indexOf(`
`,a)+1,n=o>1&&i[o-2]==="\r"?2:1,o===0&&(o=s,n=0),r=i[a],r===" "||r==="	"?e+=i.slice(a+1,o-n):(e&&t(null,e),e=i.slice(a,o-n)),a=o;while(o!==s);e=e.trim(),e.length&&t(null,e)};const ue=["tzid","location","tznames","latitude","longitude"];var ct,dt;const _=class _{constructor(t){d(this,"tzid","");d(this,"location","");d(this,"tznames","");d(this,"latitude",0);d(this,"longitude",0);d(this,"component",null);d(this,"expandedUntilYear",0);d(this,"icalclass","icaltimezone");this.wrappedJSObject=this,this.fromData(t)}static _compare_change_fn(t,e){return t.year<e.year?-1:t.year>e.year?1:t.month<e.month?-1:t.month>e.month?1:t.day<e.day?-1:t.day>e.day?1:t.hour<e.hour?-1:t.hour>e.hour?1:t.minute<e.minute?-1:t.minute>e.minute?1:t.second<e.second?-1:t.second>e.second?1:0}static convert_time(t,e,r){if(t.isDate||e.tzid==r.tzid||e==_.localTimezone||r==_.localTimezone)return t.zone=r,t;let n=e.utcOffset(t);return t.adjust(0,0,0,-n),n=r.utcOffset(t),t.adjust(0,0,0,n),null}static fromData(t){return new _().fromData(t)}static get utcTimezone(){return v(this,ct)||x(this,ct,_.fromData({tzid:"UTC"})),v(this,ct)}static get localTimezone(){return v(this,dt)||x(this,dt,_.fromData({tzid:"floating"})),v(this,dt)}static adjust_change(t,e,r,n,s){return y.prototype.adjust.call(t,e,r,n,s,t)}fromData(t){if(this.expandedUntilYear=0,this.changes=[],t instanceof j)this.component=t;else{if(t&&"component"in t)if(typeof t.component=="string"){let e=Y(t.component);this.component=new j(e)}else t.component instanceof j?this.component=t.component:this.component=null;for(let e of ue)t&&e in t&&(this[e]=t[e])}return this.component instanceof j&&!this.tzid&&(this.tzid=this.component.getFirstPropertyValue("tzid")),this}utcOffset(t){if(this==_.utcTimezone||this==_.localTimezone||(this._ensureCoverage(t.year),!this.changes.length))return 0;let e={year:t.year,month:t.month,day:t.day,hour:t.hour,minute:t.minute,second:t.second},r=this._findNearbyChange(e),n=-1,s=1;for(;;){let o=ot(this.changes[r],!0);if(o.utcOffset<o.prevUtcOffset?_.adjust_change(o,0,0,0,o.utcOffset):_.adjust_change(o,0,0,0,o.prevUtcOffset),_._compare_change_fn(e,o)>=0?n=r:s=-1,s==-1&&n!=-1)break;if(r+=s,r<0)return 0;if(r>=this.changes.length)break}let a=this.changes[n];if(a.utcOffset-a.prevUtcOffset<0&&n>0){let o=ot(a,!0);if(_.adjust_change(o,0,0,0,o.prevUtcOffset),_._compare_change_fn(e,o)<0){let l=this.changes[n-1],u=!1;a.is_daylight!=u&&l.is_daylight==u&&(a=l)}}return a.utcOffset}_findNearbyChange(t){let e=nt(this.changes,t,_._compare_change_fn);return e>=this.changes.length?this.changes.length-1:e}_ensureCoverage(t){if(_._minimumExpansionYear==-1){let r=y.now();_._minimumExpansionYear=r.year}let e=t;if(e<_._minimumExpansionYear&&(e=_._minimumExpansionYear),e+=_.EXTRA_COVERAGE,!this.changes.length||this.expandedUntilYear<t){let r=this.component.getAllSubcomponents(),n=r.length,s=0;for(;s<n;s++)this._expandComponent(r[s],e,this.changes);this.changes.sort(_._compare_change_fn),this.expandedUntilYear=e}}_expandComponent(t,e,r){if(!t.hasProperty("dtstart")||!t.hasProperty("tzoffsetto")||!t.hasProperty("tzoffsetfrom"))return null;let n,s=t.getFirstProperty("dtstart").getFirstValue();function a(l){return l.factor*(3600*l.hours+60*l.minutes)}function o(){let l={};return l.is_daylight=t.name=="daylight",l.utcOffset=a(t.getFirstProperty("tzoffsetto").getFirstValue()),l.prevUtcOffset=a(t.getFirstProperty("tzoffsetfrom").getFirstValue()),l}if(t.hasProperty("rrule")||t.hasProperty("rdate")){let l=t.getAllProperties("rdate");for(let h of l){let c=h.getFirstValue();n=o(),n.year=c.year,n.month=c.month,n.day=c.day,c.isDate?(n.hour=s.hour,n.minute=s.minute,n.second=s.second,s.zone!=_.utcTimezone&&_.adjust_change(n,0,0,0,-n.prevUtcOffset)):(n.hour=c.hour,n.minute=c.minute,n.second=c.second,c.zone!=_.utcTimezone&&_.adjust_change(n,0,0,0,-n.prevUtcOffset)),r.push(n)}let u=t.getFirstProperty("rrule");if(u){u=u.getFirstValue(),n=o(),u.until&&u.until.zone==_.utcTimezone&&(u.until.adjust(0,0,0,n.prevUtcOffset),u.until.zone=_.localTimezone);let h,c=u.iterator(s);for(;(h=c.next())&&(n=o(),!(h.year>e)&&h);)n.year=h.year,n.month=h.month,n.day=h.day,n.hour=h.hour,n.minute=h.minute,n.second=h.second,n.isDate=h.isDate,_.adjust_change(n,0,0,0,-n.prevUtcOffset),r.push(n)}}else n=o(),n.year=s.year,n.month=s.month,n.day=s.day,n.hour=s.hour,n.minute=s.minute,n.second=s.second,_.adjust_change(n,0,0,0,-n.prevUtcOffset),r.push(n);return r}toString(){return this.tznames?this.tznames:this.tzid}};ct=new WeakMap,dt=new WeakMap,H(_,ct,null),H(_,dt,null),d(_,"_minimumExpansionYear",-1),d(_,"EXTRA_COVERAGE",5);let O=_,z=null;const Et={get count(){return z===null?0:Object.keys(z).length},reset:function(){z=Object.create(null);let i=O.utcTimezone;z.Z=i,z.UTC=i,z.GMT=i},has:function(i){return z!==null&&!!z[i]},get:function(i){return z===null&&this.reset(),z[i]},register:function(i,t){if(z===null&&this.reset(),i instanceof j&&i.name==="vtimezone"&&(i=(t=new O(i)).tzid),!(t instanceof O))throw new TypeError("timezone must be ICAL.Timezone or ICAL.Component");z[i]=t},remove:function(i){return z===null?null:delete z[i]}};function gt(i){return typeof i=="number"&&isNaN(i)}function B(i){let t=parseInt(i,10);if(gt(t))throw new Error('Could not extract integer from "'+i+'"');return t}function Z(i,t){if(i!==void 0)return i instanceof t?i:new t(i)}function W(i,t,e){for(;(e=i.indexOf(t,e))!==-1;){if(!(e>0&&i[e-1]==="\\"))return e;e+=1}return-1}function nt(i,t,e){if(!i.length)return 0;let r,n,s=0,a=i.length-1;for(;s<=a;)if(r=s+Math.floor((a-s)/2),n=e(t,i[r]),n<0)a=r-1;else{if(!(n>0))break;s=r+1}return n<0?r:n>0?r+1:r}function ot(i,t){if(i&&typeof i=="object"){if(i instanceof Date)return new Date(i.getTime());if("clone"in i)return i.clone();if(Array.isArray(i)){let e=[];for(let r=0;r<i.length;r++)e.push(t?ot(i[r],!0):i[r]);return e}{let e={};for(let[r,n]of Object.entries(i))e[r]=t?ot(n,!0):n;return e}}return i}function Gt(i){let t="",e=i||"",r=0,n=0;for(;e.length;){let s=e.codePointAt(r);s<128?++n:n+=s<2048?2:s<65536?3:4,n<ht.foldLength+1?r+=s>65535?2:1:(t+=ht.newLineChar+" "+e.slice(0,Math.max(0,r)),e=e.slice(Math.max(0,r)),r=n=0)}return t.slice(ht.newLineChar.length+1)}function U(i){switch(typeof i!="string"&&(typeof i=="number"&&(i=parseInt(i)),i=String(i)),i.length){case 0:return"00";case 1:return"0"+i;default:return i}}function C(i){return i<0?Math.ceil(i):Math.floor(i)}function lt(i,t){for(let e in i){let r=Object.getOwnPropertyDescriptor(i,e);r&&!Object.getOwnPropertyDescriptor(t,e)&&Object.defineProperty(t,e,r)}return t}var ce=Object.freeze({__proto__:null,updateTimezones:function(i){let t,e,r,n,s;if(!i||i.name!=="vcalendar")return i;for(t=i.getAllSubcomponents(),e=[],r={},s=0;s<t.length;s++)t[s].name==="vtimezone"?r[t[s].getFirstProperty("tzid").getFirstValue()]=t[s]:e=e.concat(t[s].getAllProperties());for(n={},s=0;s<e.length;s++){let a=e[s].getParameter("tzid");a&&(n[a]=!0)}for(let[a,o]of Object.entries(r))n[a]||i.removeSubcomponent(o);for(let a of Object.keys(n))!r[a]&&Et.has(a)&&i.addSubcomponent(Et.get(a).component);return i},isStrictlyNaN:gt,strictParseInt:B,formatClassType:Z,unescapedIndexOf:W,binsearchInsert:nt,clone:ot,foldline:Gt,pad2:U,trunc:C,extend:lt});class F{constructor(t){d(this,"hours",0);d(this,"minutes",0);d(this,"factor",1);d(this,"icaltype","utc-offset");this.fromData(t)}static fromString(t){let e={};return e.factor=t[0]==="+"?1:-1,e.hours=B(t.slice(1,3)),e.minutes=B(t.slice(4,6)),new F(e)}static fromSeconds(t){let e=new F;return e.fromSeconds(t),e}clone(){return F.fromSeconds(this.toSeconds())}fromData(t){if(t)for(let[e,r]of Object.entries(t))this[e]=r;this._normalize()}fromSeconds(t){let e=Math.abs(t);return this.factor=t<0?-1:1,this.hours=C(e/3600),e-=3600*this.hours,this.minutes=C(e/60),this}toSeconds(){return this.factor*(60*this.minutes+3600*this.hours)}compare(t){let e=this.toSeconds(),r=t.toSeconds();return(e>r)-(r>e)}_normalize(){let t=this.toSeconds(),e=this.factor;for(;t<-43200;)t+=97200;for(;t>50400;)t-=97200;this.fromSeconds(t),t==0&&(this.factor=e)}toICALString(){return N.icalendar.value["utc-offset"].toICAL(this.toString())}toString(){return(this.factor==1?"+":"-")+U(this.hours)+":"+U(this.minutes)}}class tt extends y{constructor(e,r,n){super(e,r);d(this,"icalclass","vcardtime");d(this,"icaltype","date-and-or-time");this.icaltype=n||"date-and-or-time"}static fromDateAndOrTimeString(e,r){function n(E,w,G){return E?B(E.slice(w,w+G)):null}let s=e.split("T"),a=s[0],o=s[1],l=o?N.vcard.value.time._splitZone(o):[],u=l[0],h=l[1],c=a?a.length:0,f=h?h.length:0,g=a&&a[0]=="-"&&a[1]=="-",D=h&&h[0]=="-",p={year:g?null:n(a,0,4),month:!g||c!=4&&c!=7?c==7||c==10?n(a,5,2):null:n(a,2,2),day:c==5?n(a,3,2):c==7&&g?n(a,5,2):c==10?n(a,8,2):null,hour:D?null:n(h,0,2),minute:D&&f==3?n(h,1,2):f>4?n(h,D?1:3,2):null,second:f==4?n(h,2,2):f==6?n(h,4,2):f==8?n(h,6,2):null};return u=u=="Z"?O.utcTimezone:u&&u[3]==":"?F.fromString(u):null,new tt(p,u,r)}clone(){return new tt(this._time,this.zone,this.icaltype)}_normalize(){return this}utcOffset(){return this.zone instanceof F?this.zone.toSeconds():y.prototype.utcOffset.apply(this,arguments)}toICALString(){return N.vcard.value[this.icaltype].toICAL(this.toString())}toString(){let e,r=this.year,n=this.month,s=this.day,a=this.hour,o=this.minute,l=this.second,u=n!==null,h=s!==null,c=a!==null,f=o!==null,g=l!==null,D=(r!==null?U(r)+(u||h?"-":""):u||h?"--":"")+(u?U(n):"")+(h?"-"+U(s):""),p=(c?U(a):"-")+(c&&f?":":"")+(f?U(o):"")+(c||f?"":"-")+(f&&g?":":"")+(g?U(l):"");switch(this.zone===O.utcTimezone?e="Z":this.zone instanceof F?e=this.zone.toString():this.zone===O.localTimezone?e="":this.zone instanceof O?e=F.fromSeconds(this.zone.utcOffset(this)).toString():e="",this.icaltype){case"time":return p+e;case"date-and-or-time":case"date-time":return D+(p=="--"?"":"T"+p+e);case"date":return D}return null}}const P=class P{constructor(t){d(this,"completed",!1);d(this,"rule",null);d(this,"dtstart",null);d(this,"last",null);d(this,"occurrence_number",0);d(this,"by_indices",null);d(this,"initialized",!1);d(this,"by_data",null);d(this,"days",null);d(this,"days_index",0);this.fromData(t)}fromData(t){if(this.rule=Z(t.rule,L),!this.rule)throw new Error("iterator requires a (ICAL.Recur) rule");if(this.dtstart=Z(t.dtstart,y),!this.dtstart)throw new Error("iterator requires a (ICAL.Time) dtstart");t.by_data?this.by_data=t.by_data:this.by_data=ot(this.rule.parts,!0),t.occurrence_number&&(this.occurrence_number=t.occurrence_number),this.days=t.days||[],t.last&&(this.last=Z(t.last,y)),this.by_indices=t.by_indices,this.by_indices||(this.by_indices={BYSECOND:0,BYMINUTE:0,BYHOUR:0,BYDAY:0,BYMONTH:0,BYWEEKNO:0,BYMONTHDAY:0}),this.initialized=t.initialized||!1,this.initialized||this.init()}init(){this.initialized=!0,this.last=this.dtstart.clone();let t=this.by_data;if("BYDAY"in t&&this.sort_byday_rules(t.BYDAY),"BYYEARDAY"in t&&("BYMONTH"in t||"BYWEEKNO"in t||"BYMONTHDAY"in t||"BYDAY"in t))throw new Error("Invalid BYYEARDAY rule");if("BYWEEKNO"in t&&"BYMONTHDAY"in t)throw new Error("BYWEEKNO does not fit to BYMONTHDAY");if(this.rule.freq=="MONTHLY"&&("BYYEARDAY"in t||"BYWEEKNO"in t))throw new Error("For MONTHLY recurrences neither BYYEARDAY nor BYWEEKNO may appear");if(this.rule.freq=="WEEKLY"&&("BYYEARDAY"in t||"BYMONTHDAY"in t))throw new Error("For WEEKLY recurrences neither BYMONTHDAY nor BYYEARDAY may appear");if(this.rule.freq!="YEARLY"&&"BYYEARDAY"in t)throw new Error("BYYEARDAY may only appear in YEARLY rules");this.last.second=this.setup_defaults("BYSECOND","SECONDLY",this.dtstart.second),this.last.minute=this.setup_defaults("BYMINUTE","MINUTELY",this.dtstart.minute),this.last.hour=this.setup_defaults("BYHOUR","HOURLY",this.dtstart.hour);let e=this.last.day=this.setup_defaults("BYMONTHDAY","DAILY",this.dtstart.day);if(this.last.month=this.setup_defaults("BYMONTH","MONTHLY",this.dtstart.month),this.rule.freq=="WEEKLY")if("BYDAY"in t){let[,r]=this.ruleDayOfWeek(t.BYDAY[0],this.rule.wkst),n=r-this.last.dayOfWeek(this.rule.wkst);(this.last.dayOfWeek(this.rule.wkst)<r&&n>=0||n<0)&&(this.last.day+=n)}else{let r=L.numericDayToIcalDay(this.dtstart.dayOfWeek());t.BYDAY=[r]}if(this.rule.freq=="YEARLY"){for(;this.expand_year_days(this.last.year),!(this.days.length>0);)this.increment_year(this.rule.interval);this._nextByYearDay()}if(this.rule.freq=="MONTHLY"&&this.has_by_data("BYDAY")){let r=null,n=this.last.clone(),s=y.daysInMonth(this.last.month,this.last.year);for(let a of this.by_data.BYDAY){this.last=n.clone();let[o,l]=this.ruleDayOfWeek(a),u=this.last.nthWeekDay(l,o);if(o>=6||o<=-6)throw new Error("Malformed values in BYDAY part");if(u>s||u<=0){if(r&&r.month==n.month)continue;for(;u>s||u<=0;)this.increment_month(),s=y.daysInMonth(this.last.month,this.last.year),u=this.last.nthWeekDay(l,o)}this.last.day=u,(!r||this.last.compare(r)<0)&&(r=this.last.clone())}if(this.last=r.clone(),this.has_by_data("BYMONTHDAY")&&this._byDayAndMonthDay(!0),this.last.day>s||this.last.day==0)throw new Error("Malformed values in BYDAY part")}else if(this.has_by_data("BYMONTHDAY")){this.last.day=1;let r=y.daysInMonth(this.last.month,this.last.year);if(e<0)this.last.day=r+e+1;else if(this.by_data.BYMONTHDAY[0]>r){if(!this.next_month()&&!this.next_month()&&!this.next_month())throw new Error("No possible occurrences")}else this.last.day=e}}next(){let t,e=this.last?this.last.clone():null;if(this.rule.count&&this.occurrence_number>=this.rule.count||this.rule.until&&this.last.compare(this.rule.until)>0)return this.completed=!0,null;if(this.occurrence_number==0&&this.last.compare(this.dtstart)>=0)return this.occurrence_number++,this.last;do switch(t=1,this.rule.freq){case"SECONDLY":this.next_second();break;case"MINUTELY":this.next_minute();break;case"HOURLY":this.next_hour();break;case"DAILY":this.next_day();break;case"WEEKLY":this.next_week();break;case"MONTHLY":t=this.next_month();break;case"YEARLY":this.next_year();break;default:return null}while(!this.check_contracting_rules()||this.last.compare(this.dtstart)<0||!t);if(this.last.compare(e)==0)throw new Error("Same occurrence found twice, protecting you from death by recursion");return this.rule.until&&this.last.compare(this.rule.until)>0?(this.completed=!0,null):(this.occurrence_number++,this.last)}next_second(){return this.next_generic("BYSECOND","SECONDLY","second","minute")}increment_second(t){return this.increment_generic(t,"second",60,"minute")}next_minute(){return this.next_generic("BYMINUTE","MINUTELY","minute","hour","next_second")}increment_minute(t){return this.increment_generic(t,"minute",60,"hour")}next_hour(){return this.next_generic("BYHOUR","HOURLY","hour","monthday","next_minute")}increment_hour(t){this.increment_generic(t,"hour",24,"monthday")}next_day(){let t=this.rule.freq=="DAILY";return this.next_hour()==0||(t?this.increment_monthday(this.rule.interval):this.increment_monthday(1)),0}next_week(){let t=0;if(this.next_weekday_by_week()==0)return t;if(this.has_by_data("BYWEEKNO")){this.by_indices.BYWEEKNO++,this.by_indices.BYWEEKNO==this.by_data.BYWEEKNO.length&&(this.by_indices.BYWEEKNO=0,t=1),this.last.month=1,this.last.day=1;let e=this.by_data.BYWEEKNO[this.by_indices.BYWEEKNO];this.last.day+=7*e,t&&this.increment_year(1)}else this.increment_monthday(7*this.rule.interval);return t}normalizeByMonthDayRules(t,e,r){let n,s=y.daysInMonth(e,t),a=[],o=0,l=r.length;for(;o<l;o++)if(n=r[o],!(Math.abs(n)>s)){if(n<0)n=s+(n+1);else if(n===0)continue;a.indexOf(n)===-1&&a.push(n)}return a.sort(function(u,h){return u-h})}_byDayAndMonthDay(t){let e,r,n,s,a=this.by_data.BYDAY,o=0,l=a.length,u=0,h=this,c=this.last.day;function f(){for(s=y.daysInMonth(h.last.month,h.last.year),e=h.normalizeByMonthDayRules(h.last.year,h.last.month,h.by_data.BYMONTHDAY),n=e.length;e[o]<=c&&(!t||e[o]!=c)&&o<n-1;)o++}function g(){c=0,h.increment_month(),o=0,f()}f(),t&&(c-=1);let D=48;for(;!u&&D;){if(D--,r=c+1,r>s){g();continue}let p=e[o++];if(p>=r){c=p;for(let E=0;E<l;E++){let w=this.ruleDayOfWeek(a[E]),G=w[0],re=w[1];if(this.last.day=c,this.last.isNthWeekDay(re,G)){u=1;break}}u||o!==n||g()}else g()}if(D<=0)throw new Error("Malformed values in BYDAY combined with BYMONTHDAY parts");return u}next_month(){let t=1;if(this.next_hour()==0)return t;if(this.has_by_data("BYDAY")&&this.has_by_data("BYMONTHDAY"))t=this._byDayAndMonthDay();else if(this.has_by_data("BYDAY")){let e,r=y.daysInMonth(this.last.month,this.last.year),n=0,s=0;if(this.has_by_data("BYSETPOS")){let a=this.last.day;for(let o=1;o<=r;o++)this.last.day=o,this.is_day_in_byday(this.last)&&(s++,o<=a&&n++);this.last.day=a}for(t=0,e=this.last.day+1;e<=r;e++)if(this.last.day=e,this.is_day_in_byday(this.last)&&(!this.has_by_data("BYSETPOS")||this.check_set_position(++n)||this.check_set_position(n-s-1))){t=1;break}e>r&&(this.last.day=1,this.increment_month(),this.is_day_in_byday(this.last)?this.has_by_data("BYSETPOS")&&!this.check_set_position(1)||(t=1):t=0)}else if(this.has_by_data("BYMONTHDAY")){this.by_indices.BYMONTHDAY++,this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length&&(this.by_indices.BYMONTHDAY=0,this.increment_month());let e=y.daysInMonth(this.last.month,this.last.year),r=this.by_data.BYMONTHDAY[this.by_indices.BYMONTHDAY];r<0&&(r=e+r+1),r>e?(this.last.day=1,t=this.is_day_in_byday(this.last)):this.last.day=r}else{this.increment_month();let e=y.daysInMonth(this.last.month,this.last.year);this.by_data.BYMONTHDAY[0]>e?t=0:this.last.day=this.by_data.BYMONTHDAY[0]}return t}next_weekday_by_week(){let t=0;if(this.next_hour()==0)return t;if(!this.has_by_data("BYDAY"))return 1;for(;;){let e=new y;this.by_indices.BYDAY++,this.by_indices.BYDAY==Object.keys(this.by_data.BYDAY).length&&(this.by_indices.BYDAY=0,t=1);let r=this.by_data.BYDAY[this.by_indices.BYDAY],n=this.ruleDayOfWeek(r)[1];n-=this.rule.wkst,n<0&&(n+=7),e.year=this.last.year,e.month=this.last.month,e.day=this.last.day;let s=e.startDoyWeek(this.rule.wkst);if(n+s<1&&!t)continue;let a=y.fromDayOfYear(s+n,this.last.year);return this.last.year=a.year,this.last.month=a.month,this.last.day=a.day,t}}next_year(){if(this.next_hour()==0)return 0;if(++this.days_index==this.days.length){this.days_index=0;do this.increment_year(this.rule.interval),this.expand_year_days(this.last.year);while(this.days.length==0)}return this._nextByYearDay(),1}_nextByYearDay(){let t=this.days[this.days_index],e=this.last.year;t<1&&(t+=1,e+=1);let r=y.fromDayOfYear(t,e);this.last.day=r.day,this.last.month=r.month}ruleDayOfWeek(t,e){let r=t.match(/([+-]?[0-9])?(MO|TU|WE|TH|FR|SA|SU)/);return r?[parseInt(r[1]||0,10),t=L.icalDayToNumericDay(r[2],e)]:[0,0]}next_generic(t,e,r,n,s){let a=t in this.by_data,o=this.rule.freq==e,l=0;if(s&&this[s]()==0)return l;if(a){this.by_indices[t]++;let u=this.by_data[t];this.by_indices[t]==u.length&&(this.by_indices[t]=0,l=1),this.last[r]=u[this.by_indices[t]]}else o&&this["increment_"+r](this.rule.interval);return a&&l&&o&&this["increment_"+n](1),l}increment_monthday(t){for(let e=0;e<t;e++){let r=y.daysInMonth(this.last.month,this.last.year);this.last.day++,this.last.day>r&&(this.last.day-=r,this.increment_month())}}increment_month(){if(this.last.day=1,this.has_by_data("BYMONTH"))this.by_indices.BYMONTH++,this.by_indices.BYMONTH==this.by_data.BYMONTH.length&&(this.by_indices.BYMONTH=0,this.increment_year(1)),this.last.month=this.by_data.BYMONTH[this.by_indices.BYMONTH];else{this.rule.freq=="MONTHLY"?this.last.month+=this.rule.interval:this.last.month++,this.last.month--;let t=C(this.last.month/12);this.last.month%=12,this.last.month++,t!=0&&this.increment_year(t)}}increment_year(t){this.last.year+=t}increment_generic(t,e,r,n){this.last[e]+=t;let s=C(this.last[e]/r);this.last[e]%=r,s!=0&&this["increment_"+n](s)}has_by_data(t){return t in this.rule.parts}expand_year_days(t){let e=new y;this.days=[];let r={},n=["BYDAY","BYWEEKNO","BYMONTHDAY","BYMONTH","BYYEARDAY"];for(let a of n)a in this.rule.parts&&(r[a]=this.rule.parts[a]);if("BYMONTH"in r&&"BYWEEKNO"in r){let a=1,o={};e.year=t,e.isDate=!0;for(let l=0;l<this.by_data.BYMONTH.length;l++){let u=this.by_data.BYMONTH[l];e.month=u,e.day=1;let h=e.weekNumber(this.rule.wkst);e.day=y.daysInMonth(u,t);let c=e.weekNumber(this.rule.wkst);for(l=h;l<c;l++)o[l]=1}for(let l=0;l<this.by_data.BYWEEKNO.length&&a;l++)this.by_data.BYWEEKNO[l]<52?a&=o[l]:a=0;a?delete r.BYMONTH:delete r.BYWEEKNO}let s=Object.keys(r).length;if(s==0){let a=this.dtstart.clone();a.year=this.last.year,this.days.push(a.dayOfYear())}else if(s==1&&"BYMONTH"in r)for(let a of this.by_data.BYMONTH){let o=this.dtstart.clone();o.year=t,o.month=a,o.isDate=!0,this.days.push(o.dayOfYear())}else if(s==1&&"BYMONTHDAY"in r)for(let a of this.by_data.BYMONTHDAY){let o=this.dtstart.clone();a<0&&(a=a+y.daysInMonth(o.month,t)+1),o.day=a,o.year=t,o.isDate=!0,this.days.push(o.dayOfYear())}else if(s==2&&"BYMONTHDAY"in r&&"BYMONTH"in r)for(let a of this.by_data.BYMONTH){let o=y.daysInMonth(a,t);for(let l of this.by_data.BYMONTHDAY)l<0&&(l=l+o+1),e.day=l,e.month=a,e.year=t,e.isDate=!0,this.days.push(e.dayOfYear())}else if(!(s==1&&"BYWEEKNO"in r)){if(!(s==2&&"BYWEEKNO"in r&&"BYMONTHDAY"in r))if(s==1&&"BYDAY"in r)this.days=this.days.concat(this.expand_by_day(t));else if(s==2&&"BYDAY"in r&&"BYMONTH"in r){for(let a of this.by_data.BYMONTH){let o=y.daysInMonth(a,t);e.year=t,e.month=a,e.day=1,e.isDate=!0;let l=e.dayOfWeek(),u=e.dayOfYear()-1;e.day=o;let h=e.dayOfWeek();if(this.has_by_data("BYSETPOS")){let c=[];for(let f=1;f<=o;f++)e.day=f,this.is_day_in_byday(e)&&c.push(f);for(let f=0;f<c.length;f++)(this.check_set_position(f+1)||this.check_set_position(f-c.length))&&this.days.push(u+c[f])}else for(let c of this.by_data.BYDAY){let f,g=this.ruleDayOfWeek(c),D=g[0],p=g[1],E=(p+7-l)%7+1,w=o-(h+7-p)%7;if(D==0)for(let G=E;G<=o;G+=7)this.days.push(u+G);else D>0?(f=E+7*(D-1),f<=o&&this.days.push(u+f)):(f=w+7*(D+1),f>0&&this.days.push(u+f))}}this.days.sort(function(a,o){return a-o})}else if(s==2&&"BYDAY"in r&&"BYMONTHDAY"in r){let a=this.expand_by_day(t);for(let o of a){let l=y.fromDayOfYear(o,t);this.by_data.BYMONTHDAY.indexOf(l.day)>=0&&this.days.push(o)}}else if(s==3&&"BYDAY"in r&&"BYMONTHDAY"in r&&"BYMONTH"in r){let a=this.expand_by_day(t);for(let o of a){let l=y.fromDayOfYear(o,t);this.by_data.BYMONTH.indexOf(l.month)>=0&&this.by_data.BYMONTHDAY.indexOf(l.day)>=0&&this.days.push(o)}}else if(s==2&&"BYDAY"in r&&"BYWEEKNO"in r){let a=this.expand_by_day(t);for(let o of a){let l=y.fromDayOfYear(o,t).weekNumber(this.rule.wkst);this.by_data.BYWEEKNO.indexOf(l)&&this.days.push(o)}}else s==3&&"BYDAY"in r&&"BYWEEKNO"in r&&"BYMONTHDAY"in r||(this.days=s==1&&"BYYEARDAY"in r?this.days.concat(this.by_data.BYYEARDAY):[])}return 0}expand_by_day(t){let e=[],r=this.last.clone();r.year=t,r.month=1,r.day=1,r.isDate=!0;let n=r.dayOfWeek();r.month=12,r.day=31,r.isDate=!0;let s=r.dayOfWeek(),a=r.dayOfYear();for(let o of this.by_data.BYDAY){let l=this.ruleDayOfWeek(o),u=l[0],h=l[1];if(u==0)for(let c=(h+7-n)%7+1;c<=a;c+=7)e.push(c);else if(u>0){let c;c=h>=n?h-n+1:h-n+8,e.push(c+7*(u-1))}else{let c;u=-u,c=h<=s?a-s+h:a-s+h-7,e.push(c-7*(u-1))}}return e}is_day_in_byday(t){if(this.by_data.BYDAY)for(let e of this.by_data.BYDAY){let r=this.ruleDayOfWeek(e),n=r[0],s=r[1],a=t.dayOfWeek();if(n==0&&s==a||t.nthWeekDay(s,n)==t.day)return 1}return 0}check_set_position(t){return this.has_by_data("BYSETPOS")?this.by_data.BYSETPOS.indexOf(t)!==-1:!1}sort_byday_rules(t){for(let e=0;e<t.length;e++)for(let r=0;r<e;r++)if(this.ruleDayOfWeek(t[r],this.rule.wkst)[1]>this.ruleDayOfWeek(t[e],this.rule.wkst)[1]){let n=t[e];t[e]=t[r],t[r]=n}}check_contract_restriction(t,e){let r=P._indexMap[t],n=P._expandMap[this.rule.freq][r],s=!1;if(t in this.by_data&&n==P.CONTRACT){let a=this.by_data[t];for(let o of a)if(o==e){s=!0;break}}else s=!0;return s}check_contracting_rules(){let t=this.last.dayOfWeek(),e=this.last.weekNumber(this.rule.wkst),r=this.last.dayOfYear();return this.check_contract_restriction("BYSECOND",this.last.second)&&this.check_contract_restriction("BYMINUTE",this.last.minute)&&this.check_contract_restriction("BYHOUR",this.last.hour)&&this.check_contract_restriction("BYDAY",L.numericDayToIcalDay(t))&&this.check_contract_restriction("BYWEEKNO",e)&&this.check_contract_restriction("BYMONTHDAY",this.last.day)&&this.check_contract_restriction("BYMONTH",this.last.month)&&this.check_contract_restriction("BYYEARDAY",r)}setup_defaults(t,e,r){let n=P._indexMap[t];return P._expandMap[this.rule.freq][n]!=P.CONTRACT&&(t in this.by_data||(this.by_data[t]=[r]),this.rule.freq!=e)?this.by_data[t][0]:r}toJSON(){let t=Object.create(null);return t.initialized=this.initialized,t.rule=this.rule.toJSON(),t.dtstart=this.dtstart.toJSON(),t.by_data=this.by_data,t.days=this.days,t.last=this.last.toJSON(),t.by_indices=this.by_indices,t.occurrence_number=this.occurrence_number,t}};d(P,"_indexMap",{BYSECOND:0,BYMINUTE:1,BYHOUR:2,BYDAY:3,BYMONTHDAY:4,BYYEARDAY:5,BYWEEKNO:6,BYMONTH:7,BYSETPOS:8}),d(P,"_expandMap",{SECONDLY:[1,1,1,1,1,1,1,1],MINUTELY:[2,1,1,1,1,1,1,1],HOURLY:[2,2,1,1,1,1,1,1],DAILY:[2,2,2,1,1,1,1,1],WEEKLY:[2,2,2,2,3,3,1,1],MONTHLY:[2,2,2,2,2,3,3,1],YEARLY:[2,2,2,2,2,2,2,2]}),d(P,"UNKNOWN",0),d(P,"CONTRACT",1),d(P,"EXPAND",2),d(P,"ILLEGAL",3);let Dt=P;const de=/^(SU|MO|TU|WE|TH|FR|SA)$/,fe=/^([+-])?(5[0-3]|[1-4][0-9]|[1-9])?(SU|MO|TU|WE|TH|FR|SA)$/,$t={SU:y.SUNDAY,MO:y.MONDAY,TU:y.TUESDAY,WE:y.WEDNESDAY,TH:y.THURSDAY,FR:y.FRIDAY,SA:y.SATURDAY},me=Object.fromEntries(Object.entries($t).map(i=>i.reverse())),jt=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"];class L{constructor(t){d(this,"parts",null);d(this,"interval",1);d(this,"wkst",y.MONDAY);d(this,"until",null);d(this,"count",null);d(this,"freq",null);d(this,"icalclass","icalrecur");d(this,"icaltype","recur");this.wrappedJSObject=this,this.parts={},t&&typeof t=="object"&&this.fromData(t)}static fromString(t){let e=this._stringToData(t,!1);return new L(e)}static fromData(t){return new L(t)}static _stringToData(t,e){let r=Object.create(null),n=t.split(";"),s=n.length;for(let a=0;a<s;a++){let o=n[a].split("="),l=o[0].toUpperCase(),u=o[0].toLowerCase(),h=e?u:l,c=o[1];if(l in Bt){let f=c.split(","),g=0,D=f.length;for(;g<D;g++)f[g]=Bt[l](f[g]);r[h]=f.length==1?f[0]:f}else l in It?It[l](c,r,e):r[u]=c}return r}static icalDayToNumericDay(t,e){let r=e||y.SUNDAY;return($t[t]-r+7)%7+1}static numericDayToIcalDay(t,e){let r=t+(e||y.SUNDAY)-y.SUNDAY;return r>7&&(r-=7),me[r]}iterator(t){return new Dt({rule:this,dtstart:t})}clone(){return new L(this.toJSON())}isFinite(){return!(!this.count&&!this.until)}isByCount(){return!(!this.count||this.until)}addComponent(t,e){let r=t.toUpperCase();r in this.parts?this.parts[r].push(e):this.parts[r]=[e]}setComponent(t,e){this.parts[t.toUpperCase()]=e.slice()}getComponent(t){let e=t.toUpperCase();return e in this.parts?this.parts[e].slice():[]}getNextOccurrence(t,e){let r,n=this.iterator(t);do r=n.next();while(r&&r.compare(e)<=0);return r&&e.zone&&(r.zone=e.zone),r}fromData(t){for(let e in t){let r=e.toUpperCase();r in Bt?Array.isArray(t[e])?this.parts[r]=t[e]:this.parts[r]=[t[e]]:this[e]=t[e]}this.interval&&typeof this.interval!="number"&&It.INTERVAL(this.interval,this),this.wkst&&typeof this.wkst!="number"&&(this.wkst=L.icalDayToNumericDay(this.wkst)),!this.until||this.until instanceof y||(this.until=y.fromString(this.until))}toJSON(){let t=Object.create(null);t.freq=this.freq,this.count&&(t.count=this.count),this.interval>1&&(t.interval=this.interval);for(let[e,r]of Object.entries(this.parts))Array.isArray(r)&&r.length==1?t[e.toLowerCase()]=r[0]:t[e.toLowerCase()]=ot(r);return this.until&&(t.until=this.until.toString()),"wkst"in this&&this.wkst!==y.DEFAULT_WEEK_START&&(t.wkst=L.numericDayToIcalDay(this.wkst)),t}toString(){let t="FREQ="+this.freq;this.count&&(t+=";COUNT="+this.count),this.interval>1&&(t+=";INTERVAL="+this.interval);for(let[e,r]of Object.entries(this.parts))t+=";"+e+"="+r;return this.until&&(t+=";UNTIL="+this.until.toICALString()),"wkst"in this&&this.wkst!==y.DEFAULT_WEEK_START&&(t+=";WKST="+L.numericDayToIcalDay(this.wkst)),t}}function $(i,t,e,r){let n=r;if(r[0]==="+"&&(n=r.slice(1)),n=B(n),t!==void 0&&r<t)throw new Error(i+': invalid value "'+r+'" must be > '+t);if(e!==void 0&&r>e)throw new Error(i+': invalid value "'+r+'" must be < '+t);return n}const It={FREQ:function(i,t,e){if(jt.indexOf(i)===-1)throw new Error('invalid frequency "'+i+'" expected: "'+jt.join(", ")+'"');t.freq=i},COUNT:function(i,t,e){t.count=B(i)},INTERVAL:function(i,t,e){t.interval=B(i),t.interval<1&&(t.interval=1)},UNTIL:function(i,t,e){i.length>10?t.until=N.icalendar.value["date-time"].fromICAL(i):t.until=N.icalendar.value.date.fromICAL(i),e||(t.until=y.fromString(t.until))},WKST:function(i,t,e){if(!de.test(i))throw new Error('invalid WKST value "'+i+'"');t.wkst=L.icalDayToNumericDay(i)}},Bt={BYSECOND:$.bind(void 0,"BYSECOND",0,60),BYMINUTE:$.bind(void 0,"BYMINUTE",0,59),BYHOUR:$.bind(void 0,"BYHOUR",0,23),BYDAY:function(i){if(fe.test(i))return i;throw new Error('invalid BYDAY value "'+i+'"')},BYMONTHDAY:$.bind(void 0,"BYMONTHDAY",-31,31),BYYEARDAY:$.bind(void 0,"BYYEARDAY",-366,366),BYWEEKNO:$.bind(void 0,"BYWEEKNO",-53,53),BYMONTH:$.bind(void 0,"BYMONTH",1,12),BYSETPOS:$.bind(void 0,"BYSETPOS",-366,366)};class Q{constructor(t){d(this,"start",null);d(this,"end",null);d(this,"duration",null);d(this,"icalclass","icalperiod");d(this,"icaltype","period");if(this.wrappedJSObject=this,t&&"start"in t){if(t.start&&!(t.start instanceof y))throw new TypeError(".start must be an instance of ICAL.Time");this.start=t.start}if(t&&t.end&&t.duration)throw new Error("cannot accept both end and duration");if(t&&"end"in t){if(t.end&&!(t.end instanceof y))throw new TypeError(".end must be an instance of ICAL.Time");this.end=t.end}if(t&&"duration"in t){if(t.duration&&!(t.duration instanceof M))throw new TypeError(".duration must be an instance of ICAL.Duration");this.duration=t.duration}}static fromString(t,e){let r=t.split("/");if(r.length!==2)throw new Error('Invalid string value: "'+t+'" must contain a "/" char.');let n={start:y.fromDateTimeString(r[0],e)},s=r[1];return M.isValueString(s)?n.duration=M.fromString(s):n.end=y.fromDateTimeString(s,e),new Q(n)}static fromData(t){return new Q(t)}static fromJSON(t,e,r){function n(s,a){return r?y.fromString(s,a):y.fromDateTimeString(s,a)}return M.isValueString(t[1])?Q.fromData({start:n(t[0],e),duration:M.fromString(t[1])}):Q.fromData({start:n(t[0],e),end:n(t[1],e)})}clone(){return Q.fromData({start:this.start?this.start.clone():null,end:this.end?this.end.clone():null,duration:this.duration?this.duration.clone():null})}getDuration(){return this.duration?this.duration:this.end.subtractDate(this.start)}getEnd(){if(this.end)return this.end;{let t=this.start.clone();return t.addDuration(this.duration),t}}toString(){return this.start+"/"+(this.end||this.duration)}toJSON(){return[this.start.toString(),(this.end||this.duration).toString()]}toICALString(){return this.start.toICALString()+"/"+(this.end||this.duration).toICALString()}}const Ht=/\\\\|\\,|\\[Nn]/g,Vt=/\\|,|\n/g;function Lt(i,t){return{matches:/.*/,fromICAL:function(e,r){return function(n,s,a){return n.indexOf("\\")===-1?n:(a&&(s=new RegExp(s.source+"|\\\\"+a,s.flags)),n.replace(s,pe))}(e,i,r)},toICAL:function(e,r){let n=t;return r&&(n=new RegExp(n.source+"|"+r,n.flags)),e.replace(n,function(s){switch(s){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case`
`:return"\\n";default:return s}})}}}const T={defaultType:"text"},_t={defaultType:"text",multiValue:","},vt={defaultType:"text",structuredValue:";"},Tt={defaultType:"integer"},Yt={defaultType:"date-time",allowedTypes:["date-time","date"]},At={defaultType:"date-time"},k={defaultType:"uri"},Rt={defaultType:"utc-offset"},Wt={defaultType:"recur"},Ft={defaultType:"date-and-or-time",allowedTypes:["date-time","date","text"]};function pe(i){switch(i){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return`
`;default:return i}}let kt={categories:_t,url:k,version:T,uid:T},Pt={boolean:{values:["TRUE","FALSE"],fromICAL:function(i){return i==="TRUE"},toICAL:function(i){return i?"TRUE":"FALSE"}},float:{matches:/^[+-]?\d+\.\d+$/,fromICAL:function(i){let t=parseFloat(i);return gt(t)?0:t},toICAL:function(i){return String(i)}},integer:{fromICAL:function(i){let t=parseInt(i);return gt(t)?0:t},toICAL:function(i){return String(i)}},"utc-offset":{toICAL:function(i){return i.length<7?i.slice(0,3)+i.slice(4,6):i.slice(0,3)+i.slice(4,6)+i.slice(7,9)},fromICAL:function(i){return i.length<6?i.slice(0,3)+":"+i.slice(3,5):i.slice(0,3)+":"+i.slice(3,5)+":"+i.slice(5,7)},decorate:function(i){return F.fromString(i)},undecorate:function(i){return i.toString()}}};const I=lt(Pt,{text:Lt(/\\\\|\\;|\\,|\\[Nn]/g,/\\|;|,|\n/g),uri:{},binary:{decorate:function(i){return Nt.fromString(i)},undecorate:function(i){return i.toString()}},"cal-address":{},date:{decorate:function(i,t){return st.strict?y.fromDateString(i,t):y.fromString(i,t)},undecorate:function(i){return i.toString()},fromICAL:function(i){return!st.strict&&i.length>=15?I["date-time"].fromICAL(i):i.slice(0,4)+"-"+i.slice(4,6)+"-"+i.slice(6,8)},toICAL:function(i){let t=i.length;return t==10?i.slice(0,4)+i.slice(5,7)+i.slice(8,10):t>=19?I["date-time"].toICAL(i):i}},"date-time":{fromICAL:function(i){{let t=i.slice(0,4)+"-"+i.slice(4,6)+"-"+i.slice(6,8)+"T"+i.slice(9,11)+":"+i.slice(11,13)+":"+i.slice(13,15);return i[15]&&i[15]==="Z"&&(t+="Z"),t}},toICAL:function(i){let t=i.length;{if(t>=19){let e=i.slice(0,4)+i.slice(5,7)+i.slice(8,13)+i.slice(14,16)+i.slice(17,19);return i[19]&&i[19]==="Z"&&(e+="Z"),e}return i}},decorate:function(i,t){return st.strict?y.fromDateTimeString(i,t):y.fromString(i,t)},undecorate:function(i){return i.toString()}},duration:{decorate:function(i){return M.fromString(i)},undecorate:function(i){return i.toString()}},period:{fromICAL:function(i){let t=i.split("/");return t[0]=I["date-time"].fromICAL(t[0]),M.isValueString(t[1])||(t[1]=I["date-time"].fromICAL(t[1])),t},toICAL:function(i){return i=i.slice(),i[0]=I["date-time"].toICAL(i[0]),M.isValueString(i[1])||(i[1]=I["date-time"].toICAL(i[1])),i.join("/")},decorate:function(i,t){return Q.fromJSON(i,t,!1)},undecorate:function(i){return i.toJSON()}},recur:{fromICAL:function(i){return L._stringToData(i,!0)},toICAL:function(i){let t="";for(let[e,r]of Object.entries(i))e=="until"?r=r.length>10?I["date-time"].toICAL(r):I.date.toICAL(r):e=="wkst"?typeof r=="number"&&(r=L.numericDayToIcalDay(r)):Array.isArray(r)&&(r=r.join(",")),t+=e.toUpperCase()+"="+r+";";return t.slice(0,Math.max(0,t.length-1))},decorate:function(i){return L.fromData(i)},undecorate:function(i){return i.toJSON()}},time:{fromICAL:function(i){if(i.length<6)return i;let t=i.slice(0,2)+":"+i.slice(2,4)+":"+i.slice(4,6);return i[6]==="Z"&&(t+="Z"),t},toICAL:function(i){if(i.length<8)return i;let t=i.slice(0,2)+i.slice(3,5)+i.slice(6,8);return i[8]==="Z"&&(t+="Z"),t}}});let ye=lt(kt,{action:T,attach:{defaultType:"uri"},attendee:{defaultType:"cal-address"},calscale:T,class:T,comment:T,completed:At,contact:T,created:At,description:T,dtend:Yt,dtstamp:At,dtstart:Yt,due:Yt,duration:{defaultType:"duration"},exdate:{defaultType:"date-time",allowedTypes:["date-time","date"],multiValue:","},exrule:Wt,freebusy:{defaultType:"period",multiValue:","},geo:{defaultType:"float",structuredValue:";"},"last-modified":At,location:T,method:T,organizer:{defaultType:"cal-address"},"percent-complete":Tt,priority:Tt,prodid:T,"related-to":T,repeat:Tt,rdate:{defaultType:"date-time",allowedTypes:["date-time","date","period"],multiValue:",",detectType:function(i){return i.indexOf("/")!==-1?"period":i.indexOf("T")===-1?"date":"date-time"}},"recurrence-id":Yt,resources:_t,"request-status":vt,rrule:Wt,sequence:Tt,status:T,summary:T,transp:T,trigger:{defaultType:"duration",allowedTypes:["duration","date-time"]},tzoffsetfrom:Rt,tzoffsetto:Rt,tzurl:k,tzid:T,tzname:T});const V=lt(Pt,{text:Lt(Ht,Vt),uri:Lt(Ht,Vt),date:{decorate:function(i){return tt.fromDateAndOrTimeString(i,"date")},undecorate:function(i){return i.toString()},fromICAL:function(i){return i.length==8?I.date.fromICAL(i):i[0]=="-"&&i.length==6?i.slice(0,4)+"-"+i.slice(4):i},toICAL:function(i){return i.length==10?I.date.toICAL(i):i[0]=="-"&&i.length==7?i.slice(0,4)+i.slice(5):i}},time:{decorate:function(i){return tt.fromDateAndOrTimeString("T"+i,"time")},undecorate:function(i){return i.toString()},fromICAL:function(i){let t=V.time._splitZone(i,!0),e=t[0],r=t[1];return r.length==6?r=r.slice(0,2)+":"+r.slice(2,4)+":"+r.slice(4,6):r.length==4&&r[0]!="-"?r=r.slice(0,2)+":"+r.slice(2,4):r.length==5&&(r=r.slice(0,3)+":"+r.slice(3,5)),e.length!=5||e[0]!="-"&&e[0]!="+"||(e=e.slice(0,3)+":"+e.slice(3)),r+e},toICAL:function(i){let t=V.time._splitZone(i),e=t[0],r=t[1];return r.length==8?r=r.slice(0,2)+r.slice(3,5)+r.slice(6,8):r.length==5&&r[0]!="-"?r=r.slice(0,2)+r.slice(3,5):r.length==6&&(r=r.slice(0,3)+r.slice(4,6)),e.length!=6||e[0]!="-"&&e[0]!="+"||(e=e.slice(0,3)+e.slice(4)),r+e},_splitZone:function(i,t){let e,r,n=i.length-1,s=i.length-(t?5:6),a=i[s];return i[n]=="Z"?(e=i[n],r=i.slice(0,Math.max(0,n))):i.length>6&&(a=="-"||a=="+")?(e=i.slice(s),r=i.slice(0,Math.max(0,s))):(e="",r=i),[e,r]}},"date-time":{decorate:function(i){return tt.fromDateAndOrTimeString(i,"date-time")},undecorate:function(i){return i.toString()},fromICAL:function(i){return V["date-and-or-time"].fromICAL(i)},toICAL:function(i){return V["date-and-or-time"].toICAL(i)}},"date-and-or-time":{decorate:function(i){return tt.fromDateAndOrTimeString(i,"date-and-or-time")},undecorate:function(i){return i.toString()},fromICAL:function(i){let t=i.split("T");return(t[0]?V.date.fromICAL(t[0]):"")+(t[1]?"T"+V.time.fromICAL(t[1]):"")},toICAL:function(i){let t=i.split("T");return V.date.toICAL(t[0])+(t[1]?"T"+V.time.toICAL(t[1]):"")}},timestamp:I["date-time"],"language-tag":{matches:/^[a-zA-Z0-9-]+$/},"phone-number":{fromICAL:function(i){return Array.from(i).filter(function(t){return t==="\\"?void 0:t}).join("")},toICAL:function(i){return Array.from(i).map(function(t){return t===","||t===";"?"\\"+t:t}).join("")}}});let ge=lt(kt,{adr:{defaultType:"text",structuredValue:";",multiValue:","},anniversary:Ft,bday:Ft,caladruri:k,caluri:k,clientpidmap:vt,email:T,fburl:k,fn:T,gender:vt,geo:k,impp:k,key:k,kind:T,lang:{defaultType:"language-tag"},logo:k,member:k,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:_t,note:T,org:{defaultType:"text",structuredValue:";"},photo:k,related:k,rev:{defaultType:"timestamp"},role:T,sound:k,source:k,tel:{defaultType:"uri",allowedTypes:["uri","text"]},title:T,tz:{defaultType:"text",allowedTypes:["text","utc-offset","uri"]},xml:T}),De=lt(Pt,{binary:I.binary,date:V.date,"date-time":V["date-time"],"phone-number":V["phone-number"],uri:I.uri,text:I.text,time:I.time,vcard:I.text,"utc-offset":{toICAL:function(i){return i.slice(0,7)},fromICAL:function(i){return i.slice(0,7)},decorate:function(i){return F.fromString(i)},undecorate:function(i){return i.toString()}}}),_e=lt(kt,{fn:T,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:_t,photo:{defaultType:"binary",allowedTypes:["binary","uri"]},bday:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(i){return i.indexOf("T")===-1?"date":"date-time"}},adr:{defaultType:"text",structuredValue:";",multiValue:","},label:T,tel:{defaultType:"phone-number"},email:T,mailer:T,tz:{defaultType:"utc-offset",allowedTypes:["utc-offset","text"]},geo:{defaultType:"float",structuredValue:";"},title:T,role:T,logo:{defaultType:"binary",allowedTypes:["binary","uri"]},agent:{defaultType:"vcard",allowedTypes:["vcard","text","uri"]},org:vt,note:_t,prodid:T,rev:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(i){return i.indexOf("T")===-1?"date":"date-time"}},"sort-string":T,sound:{defaultType:"binary",allowedTypes:["binary","uri"]},class:T,key:{defaultType:"binary",allowedTypes:["binary","text"]}}),K={value:I,param:{cutype:{values:["INDIVIDUAL","GROUP","RESOURCE","ROOM","UNKNOWN"],allowXName:!0,allowIanaToken:!0},"delegated-from":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},"delegated-to":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},encoding:{values:["8BIT","BASE64"]},fbtype:{values:["FREE","BUSY","BUSY-UNAVAILABLE","BUSY-TENTATIVE"],allowXName:!0,allowIanaToken:!0},member:{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},partstat:{values:["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED","COMPLETED","IN-PROCESS"],allowXName:!0,allowIanaToken:!0},range:{values:["THISANDFUTURE"]},related:{values:["START","END"]},reltype:{values:["PARENT","CHILD","SIBLING"],allowXName:!0,allowIanaToken:!0},role:{values:["REQ-PARTICIPANT","CHAIR","OPT-PARTICIPANT","NON-PARTICIPANT"],allowXName:!0,allowIanaToken:!0},rsvp:{values:["TRUE","FALSE"]},"sent-by":{valueType:"cal-address"},tzid:{matches:/^\//},value:{values:["binary","boolean","cal-address","date","date-time","duration","float","integer","period","recur","text","time","uri","utc-offset"],allowXName:!0,allowIanaToken:!0}},property:ye,propertyGroups:!1},Kt={value:V,param:{type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","time","date-time","date-and-or-time","timestamp","boolean","integer","float","utc-offset","language-tag"],allowXName:!0,allowIanaToken:!0}},property:ge,propertyGroups:!0},Jt={value:De,param:{type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","date-time","phone-number","time","boolean","integer","float","utc-offset","vcard","binary"],allowXName:!0,allowIanaToken:!0}},property:_e,propertyGroups:!0};const st={strict:!0,defaultSet:K,defaultType:"unknown",components:{vcard:Kt,vcard3:Jt,vevent:K,vtodo:K,vjournal:K,valarm:K,vtimezone:K,daylight:K,standard:K},icalendar:K,vcard:Kt,vcard3:Jt,getDesignSet:function(i){return i&&i in st.components?st.components[i]:st.defaultSet}};var N=st;const Ot=`\r
`,qt="unknown",Te={'"':"^'","\n":"^n","^":"^^"};function S(i){typeof i[0]=="string"&&(i=[i]);let t=0,e=i.length,r="";for(;t<e;t++)r+=S.component(i[t])+Ot;return r}S.component=function(i,t){let e=i[0].toUpperCase(),r="BEGIN:"+e+Ot,n=i[1],s=0,a=n.length,o=i[0];for(o==="vcard"&&i[1].length>0&&(i[1][0][0]!=="version"||i[1][0][3]!=="4.0")&&(o="vcard3"),t=t||N.getDesignSet(o);s<a;s++)r+=S.property(n[s],t)+Ot;let l=i[2]||[],u=0,h=l.length;for(;u<h;u++)r+=S.component(l[u],t)+Ot;return r+="END:"+e,r},S.property=function(i,t,e){let r=i[0].toUpperCase(),n=i[0],s=i[1];t||(t=N.defaultSet);let a,o=s.group;a=t.propertyGroups&&o?o.toUpperCase()+"."+r:r;for(let[g,D]of Object.entries(s)){if(t.propertyGroups&&g=="group")continue;let p=t.param[g],E=p&&p.multiValue;E&&Array.isArray(D)?(D=D.map(function(w){return w=S._rfc6868Unescape(w),w=S.paramPropertyValue(w,p.multiValueSeparateDQuote)}),D=S.multiValue(D,E,"unknown",null,t)):(D=S._rfc6868Unescape(D),D=S.paramPropertyValue(D)),a+=";"+g.toUpperCase()+"="+D}if(i.length===3)return a+":";let l,u=i[2],h=!1,c=!1,f=!1;return n in t.property?(l=t.property[n],"multiValue"in l&&(h=l.multiValue),"structuredValue"in l&&Array.isArray(i[3])&&(c=l.structuredValue),"defaultType"in l?u===l.defaultType&&(f=!0):u===qt&&(f=!0)):u===qt&&(f=!0),f||(a+=";VALUE="+u.toUpperCase()),a+=":",a+=h&&c?S.multiValue(i[3],c,u,h,t,c):h?S.multiValue(i.slice(3),h,u,null,t,!1):c?S.multiValue(i[3],c,u,null,t,c):S.value(i[3],u,t,!1),e?a:Gt(a)},S.paramPropertyValue=function(i,t){return t||W(i,",")!==-1||W(i,":")!==-1||W(i,";")!==-1?'"'+i+'"':i},S.multiValue=function(i,t,e,r,n,s){let a="",o=i.length,l=0;for(;l<o;l++)r&&Array.isArray(i[l])?a+=S.multiValue(i[l],r,e,null,n,s):a+=S.value(i[l],e,n,s),l!==o-1&&(a+=t);return a},S.value=function(i,t,e,r){return t in e.value&&"toICAL"in e.value[t]?e.value[t].toICAL(i,r):i},S._rfc6868Unescape=function(i){return i.replace(/[\n^"]/g,function(t){return Te[t]})};class at{static fromString(t,e){return new at(Y.property(t,e))}constructor(t,e){this._parent=e||null,typeof t=="string"?(this.jCal=[t,{},N.defaultType],this.jCal[2]=this.getDefaultType()):this.jCal=t,this._updateType()}get type(){return this.jCal[2]}get name(){return this.jCal[0]}get parent(){return this._parent}set parent(t){let e=!this._parent||t&&t._designSet!=this._parent._designSet;this._parent=t,this.type==N.defaultType&&e&&(this.jCal[2]=this.getDefaultType(),this._updateType())}get _designSet(){return this.parent?this.parent._designSet:N.defaultSet}_updateType(){let t=this._designSet;this.type in t.value&&("decorate"in t.value[this.type]?this.isDecorated=!0:this.isDecorated=!1,this.name in t.property&&(this.isMultiValue="multiValue"in t.property[this.name],this.isStructuredValue="structuredValue"in t.property[this.name]))}_hydrateValue(t){return this._values&&this._values[t]?this._values[t]:this.jCal.length<=3+t?null:this.isDecorated?(this._values||(this._values=[]),this._values[t]=this._decorate(this.jCal[3+t])):this.jCal[3+t]}_decorate(t){return this._designSet.value[this.type].decorate(t,this)}_undecorate(t){return this._designSet.value[this.type].undecorate(t,this)}_setDecoratedValue(t,e){this._values||(this._values=[]),typeof t=="object"&&"icaltype"in t?(this.jCal[3+e]=this._undecorate(t),this._values[e]=t):(this.jCal[3+e]=t,this._values[e]=this._decorate(t))}getParameter(t){return t in this.jCal[1]?this.jCal[1][t]:void 0}getFirstParameter(t){let e=this.getParameter(t);return Array.isArray(e)?e[0]:e}setParameter(t,e){let r=t.toLowerCase();typeof e=="string"&&r in this._designSet.param&&"multiValue"in this._designSet.param[r]&&(e=[e]),this.jCal[1][t]=e}removeParameter(t){delete this.jCal[1][t]}getDefaultType(){let t=this.jCal[0],e=this._designSet;if(t in e.property){let r=e.property[t];if("defaultType"in r)return r.defaultType}return N.defaultType}resetType(t){this.removeAllValues(),this.jCal[2]=t,this._updateType()}getFirstValue(){return this._hydrateValue(0)}getValues(){let t=this.jCal.length-3;if(t<1)return[];let e=0,r=[];for(;e<t;e++)r[e]=this._hydrateValue(e);return r}removeAllValues(){this._values&&(this._values.length=0),this.jCal.length=3}setValues(t){if(!this.isMultiValue)throw new Error(this.name+`: does not not support mulitValue.
override isMultiValue`);let e=t.length,r=0;if(this.removeAllValues(),e>0&&typeof t[0]=="object"&&"icaltype"in t[0]&&this.resetType(t[0].icaltype),this.isDecorated)for(;r<e;r++)this._setDecoratedValue(t[r],r);else for(;r<e;r++)this.jCal[3+r]=t[r]}setValue(t){this.removeAllValues(),typeof t=="object"&&"icaltype"in t&&this.resetType(t.icaltype),this.isDecorated?this._setDecoratedValue(t,0):this.jCal[3]=t}toJSON(){return this.jCal}toICALString(){return S.property(this.jCal,this._designSet,!0)}}class j{constructor(t,e){d(this,"_hydratedPropertyCount",0);d(this,"_hydratedComponentCount",0);d(this,"_timezoneCache",null);typeof t=="string"&&(t=[t,[],[]]),this.jCal=t,this.parent=e||null,this.parent||this.name!=="vcalendar"||(this._timezoneCache=new Map)}static fromString(t){return new j(Y.component(t))}get name(){return this.jCal[0]}get _designSet(){return this.parent&&this.parent._designSet||N.getDesignSet(this.name)}_hydrateComponent(t){if(this._components||(this._components=[],this._hydratedComponentCount=0),this._components[t])return this._components[t];let e=new j(this.jCal[2][t],this);return this._hydratedComponentCount++,this._components[t]=e}_hydrateProperty(t){if(this._properties||(this._properties=[],this._hydratedPropertyCount=0),this._properties[t])return this._properties[t];let e=new at(this.jCal[1][t],this);return this._hydratedPropertyCount++,this._properties[t]=e}getFirstSubcomponent(t){if(t){let e=0,r=this.jCal[2],n=r.length;for(;e<n;e++)if(r[e][0]===t)return this._hydrateComponent(e)}else if(this.jCal[2].length)return this._hydrateComponent(0);return null}getAllSubcomponents(t){let e=this.jCal[2].length,r=0;if(t){let n=this.jCal[2],s=[];for(;r<e;r++)t===n[r][0]&&s.push(this._hydrateComponent(r));return s}if(!this._components||this._hydratedComponentCount!==e)for(;r<e;r++)this._hydrateComponent(r);return this._components||[]}hasProperty(t){let e=this.jCal[1],r=e.length,n=0;for(;n<r;n++)if(e[n][0]===t)return!0;return!1}getFirstProperty(t){if(t){let e=0,r=this.jCal[1],n=r.length;for(;e<n;e++)if(r[e][0]===t)return this._hydrateProperty(e)}else if(this.jCal[1].length)return this._hydrateProperty(0);return null}getFirstPropertyValue(t){let e=this.getFirstProperty(t);return e?e.getFirstValue():null}getAllProperties(t){let e=this.jCal[1].length,r=0;if(t){let n=this.jCal[1],s=[];for(;r<e;r++)t===n[r][0]&&s.push(this._hydrateProperty(r));return s}if(!this._properties||this._hydratedPropertyCount!==e)for(;r<e;r++)this._hydrateProperty(r);return this._properties||[]}_removeObjectByIndex(t,e,r){if((e=e||[])[r]){let n=e[r];"parent"in n&&(n.parent=null)}e.splice(r,1),this.jCal[t].splice(r,1)}_removeObject(t,e,r){let n=0,s=this.jCal[t],a=s.length,o=this[e];if(typeof r=="string"){for(;n<a;n++)if(s[n][0]===r)return this._removeObjectByIndex(t,o,n),!0}else if(o){for(;n<a;n++)if(o[n]&&o[n]===r)return this._removeObjectByIndex(t,o,n),!0}return!1}_removeAllObjects(t,e,r){let n=this[e],s=this.jCal[t],a=s.length-1;for(;a>=0;a--)r&&s[a][0]!==r||this._removeObjectByIndex(t,n,a)}addSubcomponent(t){this._components||(this._components=[],this._hydratedComponentCount=0),t.parent&&t.parent.removeSubcomponent(t);let e=this.jCal[2].push(t.jCal);return this._components[e-1]=t,this._hydratedComponentCount++,t.parent=this,t}removeSubcomponent(t){let e=this._removeObject(2,"_components",t);return e&&this._hydratedComponentCount--,e}removeAllSubcomponents(t){let e=this._removeAllObjects(2,"_components",t);return this._hydratedComponentCount=0,e}addProperty(t){if(!(t instanceof at))throw new TypeError("must be instance of ICAL.Property");this._properties||(this._properties=[],this._hydratedPropertyCount=0),t.parent&&t.parent.removeProperty(t);let e=this.jCal[1].push(t.jCal);return this._properties[e-1]=t,this._hydratedPropertyCount++,t.parent=this,t}addPropertyWithValue(t,e){let r=new at(t);return r.setValue(e),this.addProperty(r),r}updatePropertyWithValue(t,e){let r=this.getFirstProperty(t);return r?r.setValue(e):r=this.addPropertyWithValue(t,e),r}removeProperty(t){let e=this._removeObject(1,"_properties",t);return e&&this._hydratedPropertyCount--,e}removeAllProperties(t){let e=this._removeAllObjects(1,"_properties",t);return this._hydratedPropertyCount=0,e}toJSON(){return this.jCal}toString(){return S.component(this.jCal,this._designSet)}getTimeZoneByID(t){if(this.parent)return this.parent.getTimeZoneByID(t);if(!this._timezoneCache)return null;if(this._timezoneCache.has(t))return this._timezoneCache.get(t);const e=this.getAllSubcomponents("vtimezone");for(const r of e)if(r.getFirstProperty("tzid").getFirstValue()===t){const n=new O({component:r,tzid:t});return this._timezoneCache.set(t,n),n}return null}}class Xt{constructor(t){d(this,"complete",!1);d(this,"ruleIterators",null);d(this,"ruleDates",null);d(this,"exDates",null);d(this,"ruleDateInc",0);d(this,"exDateInc",0);d(this,"exDate",null);d(this,"ruleDate",null);d(this,"dtstart",null);d(this,"last",null);this.ruleDates=[],this.exDates=[],this.fromData(t)}fromData(t){let e=Z(t.dtstart,y);if(!e)throw new Error(".dtstart (ICAL.Time) must be given");if(this.dtstart=e,t.component)this._init(t.component);else{if(this.last=Z(t.last,y)||e.clone(),!t.ruleIterators)throw new Error(".ruleIterators or .component must be given");this.ruleIterators=t.ruleIterators.map(function(r){return Z(r,Dt)}),this.ruleDateInc=t.ruleDateInc,this.exDateInc=t.exDateInc,t.ruleDates&&(this.ruleDates=t.ruleDates.map(r=>Z(r,y)),this.ruleDate=this.ruleDates[this.ruleDateInc]),t.exDates&&(this.exDates=t.exDates.map(r=>Z(r,y)),this.exDate=this.exDates[this.exDateInc]),t.complete!==void 0&&(this.complete=t.complete)}}next(){let t,e,r,n=0;for(;;){if(n++>500)throw new Error("max tries have occurred, rule may be impossible to fulfill.");if(e=this.ruleDate,t=this._nextRecurrenceIter(this.last),!e&&!t){this.complete=!0;break}if((!e||t&&e.compare(t.last)>0)&&(e=t.last.clone(),t.next()),this.ruleDate===e&&this._nextRuleDay(),this.last=e,!this.exDate||(r=this.exDate.compare(this.last),r<0&&this._nextExDay(),r!==0))return this.last;this._nextExDay()}}toJSON(){function t(r){return r.toJSON()}let e=Object.create(null);return e.ruleIterators=this.ruleIterators.map(t),this.ruleDates&&(e.ruleDates=this.ruleDates.map(t)),this.exDates&&(e.exDates=this.exDates.map(t)),e.ruleDateInc=this.ruleDateInc,e.exDateInc=this.exDateInc,e.last=this.last.toJSON(),e.dtstart=this.dtstart.toJSON(),e.complete=this.complete,e}_extractDates(t,e){let r=[],n=t.getAllProperties(e);for(let s=0,a=n.length;s<a;s++)for(let o of n[s].getValues()){let l=nt(r,o,(u,h)=>u.compare(h));r.splice(l,0,o)}return r}_init(t){if(this.ruleIterators=[],this.last=this.dtstart.clone(),!t.hasProperty("rdate")&&!t.hasProperty("rrule")&&!t.hasProperty("recurrence-id"))return this.ruleDate=this.last.clone(),void(this.complete=!0);if(t.hasProperty("rdate")&&(this.ruleDates=this._extractDates(t,"rdate"),this.ruleDates[0]&&this.ruleDates[0].compare(this.dtstart)<0?(this.ruleDateInc=0,this.last=this.ruleDates[0].clone()):this.ruleDateInc=nt(this.ruleDates,this.last,(e,r)=>e.compare(r)),this.ruleDate=this.ruleDates[this.ruleDateInc]),t.hasProperty("rrule")){let e,r,n=t.getAllProperties("rrule"),s=0,a=n.length;for(;s<a;s++)e=n[s].getFirstValue(),r=e.iterator(this.dtstart),this.ruleIterators.push(r),r.next()}t.hasProperty("exdate")&&(this.exDates=this._extractDates(t,"exdate"),this.exDateInc=nt(this.exDates,this.last,(e,r)=>e.compare(r)),this.exDate=this.exDates[this.exDateInc])}_nextExDay(){this.exDate=this.exDates[++this.exDateInc]}_nextRuleDay(){this.ruleDate=this.ruleDates[++this.ruleDateInc]}_nextRecurrenceIter(){let t=this.ruleIterators;if(t.length===0)return null;let e,r,n,s=t.length,a=0;for(;a<s;a++)e=t[a],r=e.last,e.completed?(s--,a!==0&&a--,t.splice(a,1)):(!n||n.last.compare(r)>0)&&(n=e);return n}}const yt=class yt{constructor(t,e){d(this,"exceptions",null);d(this,"strictExceptions",!1);t instanceof j||(e=t,t=null),this.component=t||new j("vevent"),this._rangeExceptionCache=Object.create(null),this.exceptions=Object.create(null),this.rangeExceptions=[],e&&e.strictExceptions&&(this.strictExceptions=e.strictExceptions),e&&e.exceptions?e.exceptions.forEach(this.relateException,this):this.component.parent&&!this.isRecurrenceException()&&this.component.parent.getAllSubcomponents("vevent").forEach(function(r){r.hasProperty("recurrence-id")&&this.relateException(r)},this)}relateException(t){if(this.isRecurrenceException())throw new Error("cannot relate exception to exceptions");if(t instanceof j&&(t=new yt(t)),this.strictExceptions&&t.uid!==this.uid)throw new Error("attempted to relate unrelated exception");let e=t.recurrenceId.toString();if(this.exceptions[e]=t,t.modifiesFuture()){let r=[t.recurrenceId.toUnixTime(),e],n=nt(this.rangeExceptions,r,Zt);this.rangeExceptions.splice(n,0,r)}}modifiesFuture(){return this.component.hasProperty("recurrence-id")?this.component.getFirstProperty("recurrence-id").getParameter("range")===yt.THISANDFUTURE:!1}findRangeException(t){if(!this.rangeExceptions.length)return null;let e=t.toUnixTime(),r=nt(this.rangeExceptions,[e],Zt);if(r-=1,r<0)return null;let n=this.rangeExceptions[r];return e<n[0]?null:n[1]}getOccurrenceDetails(t){let e,r=t.toString(),n=t.convertToZone(O.utcTimezone).toString(),s={recurrenceId:t};if(r in this.exceptions)e=s.item=this.exceptions[r],s.startDate=e.startDate,s.endDate=e.endDate,s.item=e;else if(n in this.exceptions)e=this.exceptions[n],s.startDate=e.startDate,s.endDate=e.endDate,s.item=e;else{let a,o=this.findRangeException(t);if(o){let l=this.exceptions[o];s.item=l;let u=this._rangeExceptionCache[o];if(!u){let c=l.recurrenceId.clone(),f=l.startDate.clone();c.zone=f.zone,u=f.subtractDate(c),this._rangeExceptionCache[o]=u}let h=t.clone();h.zone=l.startDate.zone,h.addDuration(u),a=h.clone(),a.addDuration(l.duration),s.startDate=h,s.endDate=a}else a=t.clone(),a.addDuration(this.duration),s.endDate=a,s.startDate=t,s.item=this}return s}iterator(t){return new Xt({component:this.component,dtstart:t||this.startDate})}isRecurring(){let t=this.component;return t.hasProperty("rrule")||t.hasProperty("rdate")}isRecurrenceException(){return this.component.hasProperty("recurrence-id")}getRecurrenceTypes(){let t=this.component.getAllProperties("rrule"),e=0,r=t.length,n=Object.create(null);for(;e<r;e++)n[t[e].getFirstValue().freq]=!0;return n}get uid(){return this._firstProp("uid")}set uid(t){this._setProp("uid",t)}get startDate(){return this._firstProp("dtstart")}set startDate(t){this._setTime("dtstart",t)}get endDate(){let t=this._firstProp("dtend");if(!t){let e=this._firstProp("duration");t=this.startDate.clone(),e?t.addDuration(e):t.isDate&&(t.day+=1)}return t}set endDate(t){this.component.hasProperty("duration")&&this.component.removeProperty("duration"),this._setTime("dtend",t)}get duration(){return this._firstProp("duration")||this.endDate.subtractDateTz(this.startDate)}set duration(t){this.component.hasProperty("dtend")&&this.component.removeProperty("dtend"),this._setProp("duration",t)}get location(){return this._firstProp("location")}set location(t){this._setProp("location",t)}get attendees(){return this.component.getAllProperties("attendee")}get summary(){return this._firstProp("summary")}set summary(t){this._setProp("summary",t)}get description(){return this._firstProp("description")}set description(t){this._setProp("description",t)}get color(){return this._firstProp("color")}set color(t){this._setProp("color",t)}get organizer(){return this._firstProp("organizer")}set organizer(t){this._setProp("organizer",t)}get sequence(){return this._firstProp("sequence")}set sequence(t){this._setProp("sequence",t)}get recurrenceId(){return this._firstProp("recurrence-id")}set recurrenceId(t){this._setTime("recurrence-id",t)}_setTime(t,e){let r=this.component.getFirstProperty(t);r||(r=new at(t),this.component.addProperty(r)),e.zone===O.localTimezone||e.zone===O.utcTimezone?r.removeParameter("tzid"):r.setParameter("tzid",e.zone.tzid),r.setValue(e)}_setProp(t,e){this.component.updatePropertyWithValue(t,e)}_firstProp(t){return this.component.getFirstPropertyValue(t)}toString(){return this.component.toString()}};d(yt,"THISANDFUTURE","THISANDFUTURE");let wt=yt;function Zt(i,t){return i[0]>t[0]?1:t[0]>i[0]?-1:0}var ht={foldLength:75,debug:!1,newLineChar:`\r
`,Binary:Nt,Component:j,ComponentParser:class{constructor(i){d(this,"parseEvent",!0);d(this,"parseTimezone",!0);d(this,"oncomplete",function(){});d(this,"onerror",function(i){});d(this,"ontimezone",function(i){});d(this,"onevent",function(i){});i===void 0&&(i={});for(let[t,e]of Object.entries(i))this[t]=e}process(i){typeof i=="string"&&(i=Y(i)),i instanceof j||(i=new j(i));let t,e=i.getAllSubcomponents(),r=0,n=e.length;for(;r<n;r++)switch(t=e[r],t.name){case"vtimezone":if(this.parseTimezone){let s=t.getFirstPropertyValue("tzid");s&&this.ontimezone(new O({tzid:s,component:t}))}break;case"vevent":this.parseEvent&&this.onevent(new wt(t));break;default:continue}this.oncomplete()}},Duration:M,Event:wt,Period:Q,Property:at,Recur:L,RecurExpansion:Xt,RecurIterator:Dt,Time:y,Timezone:O,TimezoneService:Et,UtcOffset:F,VCardTime:tt,parse:Y,stringify:S,design:N,helpers:ce};const Ye=`
                 <ul>
                   <style></style>
                   <li part="summary"><slot name="summary"></slot></li>
                   <li part="description"><slot name="description"></slot></li>
                   <li part="location"><slot name="location"></slot></li>
                   <li part="startDate"><time><slot name="startDate"></slot></time></li>
                   <li part="endDate"><time><slot name="endDate"></slot></time></li>
                   <li><slot name="duration"></slot></li>
                   <li><slot name="organizer"></slot></li>
                   <li><slot name="attendees"></slot></li>
                 </ul>
             `;var rt,ft,R,q,it,mt,A,pt,bt,zt,Ct,Qt,te,ee,St,X;const J=class J extends HTMLElement{constructor(){super();H(this,A);H(this,rt);H(this,ft,"gregory");H(this,R,[]);H(this,q);H(this,it);x(this,it,this.attachShadow({mode:"open"})),b(this,A,ee).call(this)}static get observedAttributes(){return["src","events","refresh","since","until","locales","localeOptions"]}connectedCallback(){this.refresh?b(this,A,bt).call(this,this.refresh):this.src&&!this.events?b(this,A,St).call(this).then(()=>b(this,A,X).call(this)):b(this,A,X).call(this)}disconnectedCallback(){b(this,A,pt).call(this)}get src(){return this.getAttribute("src")}set src(e){e?this.setAttribute("src",e):this.removeAttribute("src")}get events(){var e;return(e=this.getAttribute("events"))==null?void 0:e.trim()}set events(e){e?this.setAttribute("events",e):this.removeAttribute("events")}setEventsList(e){x(this,R,e),b(this,A,X).call(this)}get filteredEvents(){var s;let e;if(this.since)try{e=this.since?new Date(this.since):void 0}catch{}let r;if(this.until)try{r=this.until?new Date(this.until):void 0}catch{}return((s=v(this,R))==null?void 0:s.filter(a=>{const o=a.startDate.toJSDate(),l=a.endDate.toJSDate();return!(e&&o<e||r&&l>r)}))??[]}get until(){return this.getAttribute("until")}set until(e){e?this.setAttribute("until",e):this.removeAttribute("until")}get since(){return this.getAttribute("since")}set since(e){e?this.setAttribute("since",e):this.removeAttribute("since")}get calScale(){return v(this,ft).toLowerCase()}get locales(){var e;return((e=this.getAttribute("locales"))==null?void 0:e.split(","))??[]}set locales(e){e?this.setAttribute("locales",Array.isArray(e)?e.join(","):e):this.removeAttribute("locales")}get localeOptions(){const e=JSON.parse(this.getAttribute("localeOptions")??"{}");return{calendar:this.calScale,...e}}set localeOptions(e){e?this.setAttribute("localeOptions",JSON.stringify(e)):this.removeAttribute("localeOptions")}get refresh(){var e;return v(e=J,mt).call(e,this.getAttribute("refresh"))}set refresh(e){var r;e=v(r=J,mt).call(r,e),e?this.setAttribute("refresh",String(e)):this.removeAttribute("refresh")}get hasFixedEvents(){return!this.src||this.src.trim().length===0}attributeChangedCallback(e,r,n){if(r!=n)switch(e){case"src":{n?b(this,A,bt).call(this,this.refresh):b(this,A,pt).call(this);break}case"refresh":{b(this,A,bt).call(this,this.refresh);break}case"events":{if(n)try{x(this,R,b(this,A,zt).call(this,n))}catch(s){x(this,q,`Failed to parse events: ${(s==null?void 0:s.message)??JSON.stringify(s)}`)}else x(this,R,[]);this.hasFixedEvents&&b(this,A,pt).call(this),b(this,A,X).call(this)}default:{b(this,A,X).call(this);break}}}valueOf(){return v(this,R)}toJSON(){return v(this,R)}toString(){return JSON.stringify(v(this,R))}};rt=new WeakMap,ft=new WeakMap,R=new WeakMap,q=new WeakMap,it=new WeakMap,mt=new WeakMap,A=new WeakSet,pt=function(){v(this,rt)&&(clearInterval(v(this,rt)),x(this,rt,void 0))},bt=function(e){var n;b(this,A,pt).call(this);const r=v(n=J,mt).call(n,e);r&&this.src&&(x(this,rt,setInterval(()=>{b(this,A,St).call(this).then(()=>b(this,A,X).call(this))},r*1e3)),b(this,A,St).call(this).then(()=>b(this,A,X).call(this)))},zt=function(e){try{const r=ht.parse(e),n=new ht.Component(r),s=n.getFirstPropertyValue("calscale")??"gregory";console.debug(`calScale: ${s}`),s==="GREGORIAN"?x(this,ft,"gregory"):x(this,ft,String(s).toLowerCase());const o=n.getAllSubcomponents("vevent").map(l=>new ht.Event(l));return console.debug(o),o}catch(r){return console.warn(`Couldn't parse ical data: ${(r==null?void 0:r.message)??JSON.stringify(r)}`),[]}},Ct=new WeakSet,Qt=function(e){const r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(r).filter(s=>!(s.startsWith("_")||["constructor"].includes(s)||typeof e[s]=="function"));return Object.fromEntries(n.map(s=>[s,e[s]]))},te=function(e){if(this&&this.hasOwnProperty(e)){let r=this[e];delete this[e],this[e]=r}},ee=function(){J.observedAttributes.forEach(b(this,A,te))},St=async function(){if(this.src)return await fetch(this.src).then(async e=>{if(e.ok){const r=await e.text();x(this,R,b(this,A,zt).call(this,r)),x(this,q,void 0)}else x(this,q,`${e.status} ${e.statusText}`.trim())}).catch(e=>{x(this,q,`${(e==null?void 0:e.message)??JSON.stringify(e)}`.trim())})},X=async function(){let e=this.querySelector("template");e||(e=document.createElement("template"),e.innerHTML=Ye);const r=e.querySelector("style");let n;r&&(n=r.cloneNode(!0),e.removeChild(r));const s="<slot></slot>";v(this,q)?v(this,it).innerHTML=`${(n==null?void 0:n.outerHTML)??""}<slot name="error" class="error"><p class="error">${v(this,q)}</p></slot>${s}`:this.filteredEvents.length==0?v(this,it).innerHTML=`${(n==null?void 0:n.outerHTML)??""}<slot name="empty" class="empty"></slot>${s}`:v(this,it).innerHTML=`${(n==null?void 0:n.outerHTML)??""}<ol>${this.filteredEvents.map(a=>{var h;const o=e.content.cloneNode(!0),l=b(h=J,Ct,Qt).call(h,a);Object.entries(l).forEach(([c,f])=>{(f||f===0)&&(console.debug("looking for slots",c,f),o.querySelectorAll(`slot[name="${c}"]`).forEach(g=>{console.debug("- found slot",c,f);const D=g.parentElement;if(D&&["startDate","endDate"].includes(c)){const p=f.toJSDate(),E=p.toISOString(),w=p.toLocaleString(this.locales,this.localeOptions);try{D.dateTime=E}catch{}D.innerHTML=w}else g.replaceWith(String(f))}))}),console.debug("thisEventNode",o,String(o));const u=document.createElement("li");return u.appendChild(o),u.outerHTML}).join("")}</ol>${s}`},H(J,Ct),H(J,mt,e=>e&&!isNaN(parseInt(e))&&e>0?parseInt(e):0);let Mt=J;window.addEventListener("DOMContentLoaded",()=>{customElements.get("i-cal")||customElements.define("i-cal",Mt)});
//# sourceMappingURL=index-DrUcE282.js.map
