var q=a=>{throw TypeError(a)};var V=(a,s,e)=>s.has(a)||q("Cannot "+e);var t=(a,s,e)=>(V(a,s,"read from private field"),e?e.call(a):s.get(a)),c=(a,s,e)=>s.has(a)?q("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(a):s.set(a,e),n=(a,s,e,i)=>(V(a,s,"write to private field"),i?i.call(a,e):s.set(a,e),e),l=(a,s,e)=>(V(a,s,"access private method"),e);var v,w,A,T;class _{constructor(s,e){c(this,v);c(this,w);c(this,A);c(this,T);const{elLen:i=0,dividerLen:r=0,maxTextLen:f=0}=e??{};n(this,v,i),n(this,w,r),n(this,A,f),n(this,T,s)}get elLen(){return t(this,v)}set elLen(s){s!==t(this,v)&&(n(this,v,s),t(this,T).call(this,this))}get dividerLen(){return t(this,w)}set dividerLen(s){s!==t(this,w)&&(n(this,w,s),t(this,T).call(this,this))}get maxTextLen(){return t(this,A)}set maxTextLen(s){s!==t(this,A)&&(n(this,A,s),t(this,T).call(this,this))}}v=new WeakMap,w=new WeakMap,A=new WeakMap,T=new WeakMap;var p,o,m,u,z,I,b,d,x,h,N,F,W,O,k;class j extends HTMLElement{constructor(){super();c(this,h);c(this,p);c(this,o,[]);c(this,m);c(this,u);c(this,z,"…");c(this,I,!0);c(this,b);c(this,d);c(this,x);window.addEventListener("resize",()=>{l(this,h,k).call(this)}),window.addEventListener("focus",()=>{n(this,I,!0),l(this,h,k).call(this)}),window.addEventListener("blur",()=>{n(this,I,!1),l(this,h,F).call(this)}),document.addEventListener("visibilitychange",()=>{document.hidden?l(this,h,F).call(this):l(this,h,k).call(this)}),n(this,d,new _(e=>{l(this,h,O).call(this)})),n(this,x,this.attachInternals())}static get observedAttributes(){return["title","at","divider","disabled","ms","truncated"]}connectedCallback(){t(this,b)||n(this,b,new ResizeObserver(e=>{const{contentBoxSize:i}=e[0],{inlineSize:r}=i[0];r&&(t(this,d).elLen=r)})),t(this,b).observe(this),l(this,h,k).call(this)}disconnectedCallback(){t(this,b)&&t(this,b).disconnect(),l(this,h,F).call(this)}attributeChangedCallback(e,i,r){e==="title"&&(t(this,p)||n(this,p,new Intl.Segmenter),r?Array.from(t(this,p).segment(r)).forEach((f,C)=>{var g;t(this,o)[C]={...f,input:"",length:((g=t(this,o)[C])==null?void 0:g.length)??0}}):n(this,o,[])),e==="truncated"&&l(this,h,W).call(this,this.truncated),l(this,h,F).call(this),l(this,h,k).call(this)}get at(){if(this.hasAttribute("at"))try{return parseInt(String(this.getAttribute("at")))}catch{return 50}return 50}set at(e){if(e==null)this.removeAttribute("at");else{const i=Math.max(0,Math.min(100,parseInt(String(e))));i&&this.setAttribute("at",String(i))}}get ms(){if(this.hasAttribute("at"))try{return parseInt(String(this.getAttribute("at")))}catch{return 16}return 16}set ms(e){if(!e)this.removeAttribute("ms");else{const i=Math.max(0,parseInt(String(e)));i&&this.setAttribute("ms",String(i))}}get divider(){return this.getAttribute("divider")??t(this,z)}set divider(e){e!=null&&e.length?this.setAttribute("divider",e):this.removeAttribute("divider")}get truncated(){return t(this,x).states.has("truncated")}}p=new WeakMap,o=new WeakMap,m=new WeakMap,u=new WeakMap,z=new WeakMap,I=new WeakMap,b=new WeakMap,d=new WeakMap,x=new WeakMap,h=new WeakSet,N=function(){if(!this||!t(this,I)||!this.isConnected||document.hidden)return!1;const e=this.getBoundingClientRect(),i=10;return e.top>=-i&&e.bottom<=window.innerHeight+i&&e.left>=-i&&e.right<=window.innerWidth+i},F=function(){t(this,m)&&(cancelIdleCallback(t(this,m)),n(this,m,void 0)),t(this,u)&&(cancelAnimationFrame(t(this,u)),n(this,u,void 0))},W=function(e){const i=t(this,x).states.has("truncated"),r=this.hasAttribute("truncated");e?(i||t(this,x).states.add("truncated"),r||this.setAttribute("truncated","")):(i&&t(this,x).states.delete("truncated"),r&&this.removeAttribute("truncated"))},O=function(){t(this,u)&&(cancelAnimationFrame(t(this,u)),n(this,u,void 0));const e=r=>this.innerText!==r?(this.innerText=r??"",!0):!1,i=()=>{var r;if(this&&(!this.isConnected||this.hasAttribute("disabled")))e(this.title);else{if(!t(this,h,N))return;const f=!this.title||!((r=t(this,o))!=null&&r.length);if(l(this,h,W).call(this,f?!1:t(this,d).elLen<t(this,d).maxTextLen),f||!t(this,d).elLen||!this.truncated)e(this.title);else if(t(this,d).elLen<=t(this,d).dividerLen)e(this.divider);else{const g=Math.floor(t(this,d).elLen-t(this,d).dividerLen),L=Math.floor(g*(this.at/100)),E=Math.floor(g-L),M=t(this,o).filter(({length:P},D,R)=>Math.ceil(R.slice(0,D).reduce((B,H)=>B+H.length,0)+P)<L).length,S=t(this,o).filter(({length:P},D,R)=>Math.ceil(R.slice(-D).reduce((B,H)=>B+H.length,0)+P)>E).length,y=this.title.slice(0,M),$=this.title.slice(S);console.log("truncated",{startIdx:M,endIdx:S,startStr:y,dims:t(this,d),endStr:$,availableSpace:g,startMaxPx:L,endMaxPx:E}),e(`${y}${this.divider}${$}`)}}};i(),n(this,u,requestAnimationFrame(i))},k=function(){if(!this||t(this,m))return;const e=()=>{const i=this.innerText,{writingMode:r}=getComputedStyle(this),f=r.startsWith("vertical"),C=r.startsWith("sideways"),g=f||C,L=()=>{const{width:M,height:S}=this.getBoundingClientRect();return g?S:M};n(this,z,f?"︙":"…"),this.innerText=this.divider,t(this,d).dividerLen=Math.ceil(L());let E=0;t(this,o).forEach((M,S)=>{this.innerText=M.segment;const y=Math.ceil(L());E+=y,t(this,o)[S].length=y}),t(this,d).maxTextLen=E,this.innerText=this.title,t(this,d).elLen=Math.floor(L()),this.innerText=i,n(this,m,void 0)};n(this,m,requestIdleCallback(e,{timeout:this.ms}))};"customElements"in window&&!customElements.get("middle-truncate")&&customElements.define("middle-truncate",j);
//# sourceMappingURL=index-JJW_KXNi.js.map
