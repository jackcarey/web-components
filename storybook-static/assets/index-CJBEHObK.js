var q=r=>{throw TypeError(r)};var V=(r,i,t)=>i.has(r)||q("Cannot "+t);var e=(r,i,t)=>(V(r,i,"read from private field"),t?t.call(r):i.get(r)),a=(r,i,t)=>i.has(r)?q("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(r):i.set(r,t),n=(r,i,t,s)=>(V(r,i,"write to private field"),s?s.call(r,t):i.set(r,t),t),l=(r,i,t)=>(V(r,i,"access private method"),t);var x,L,v,w;class _{constructor(i,t){a(this,x);a(this,L);a(this,v);a(this,w);const{elLen:s=0,dividerLen:d=0,maxTextLen:u=0}=t??{};n(this,x,s),n(this,L,d),n(this,v,u),n(this,w,i)}get elLen(){return e(this,x)}set elLen(i){i!==e(this,x)&&(n(this,x,i),e(this,w).call(this,this))}get dividerLen(){return e(this,L)}set dividerLen(i){i!==e(this,L)&&(n(this,L,i),e(this,w).call(this,this))}get maxTextLen(){return e(this,v)}set maxTextLen(i){i!==e(this,v)&&(n(this,v,i),e(this,w).call(this,this))}}x=new WeakMap,L=new WeakMap,v=new WeakMap,w=new WeakMap;var C,o,g,f,A,E,k,m,c,h,N,y,$,O,M;class j extends HTMLElement{constructor(){super();a(this,h);a(this,C);a(this,o,[]);a(this,g);a(this,f);a(this,A,!1);a(this,E,"…");a(this,k,!0);a(this,m);a(this,c);window.addEventListener("resize",()=>{l(this,h,M).call(this)}),window.addEventListener("focus",()=>{n(this,k,!0),l(this,h,M).call(this)}),window.addEventListener("blur",()=>{n(this,k,!1),l(this,h,y).call(this)}),document.addEventListener("visibilitychange",()=>{document.hidden?l(this,h,y).call(this):l(this,h,M).call(this)}),n(this,c,new _(t=>{l(this,h,O).call(this)}))}static get observedAttributes(){return["title","at","divider","disabled","ms","truncated"]}connectedCallback(){e(this,m)||n(this,m,new ResizeObserver(t=>{const{contentBoxSize:s}=t[0],{inlineSize:d}=s[0];d&&(e(this,c).elLen=d)})),e(this,m).observe(this),l(this,h,M).call(this)}disconnectedCallback(){l(this,h,y).call(this),e(this,m)&&e(this,m).disconnect()}attributeChangedCallback(t,s,d){t==="title"&&(e(this,C)||n(this,C,new Intl.Segmenter),d?Array.from(e(this,C).segment(d)).forEach((u,p)=>{var b;e(this,o)[p]={...u,input:"",length:((b=e(this,o)[p])==null?void 0:b.length)??0}}):n(this,o,[])),t==="truncated"&&l(this,h,$).call(this,e(this,A)),l(this,h,M).call(this)}get at(){if(this.hasAttribute("at"))try{return parseInt(String(this.getAttribute("at")))}catch{return 50}return 50}set at(t){if(t==null)this.removeAttribute("at");else{const s=Math.max(0,Math.min(100,parseInt(String(t))));s&&this.setAttribute("at",String(s))}}get ms(){if(this.hasAttribute("at"))try{return parseInt(String(this.getAttribute("at")))}catch{return 16}return 16}set ms(t){if(!t)this.removeAttribute("ms");else{const s=Math.max(0,parseInt(String(t)));s&&this.setAttribute("ms",String(s))}}get divider(){return this.getAttribute("divider")??e(this,E)}set divider(t){t!=null&&t.length?this.setAttribute("divider",t):this.removeAttribute("divider")}get truncated(){return e(this,A)}}C=new WeakMap,o=new WeakMap,g=new WeakMap,f=new WeakMap,A=new WeakMap,E=new WeakMap,k=new WeakMap,m=new WeakMap,c=new WeakMap,h=new WeakSet,N=function(){if(!this||!e(this,k)||!this.isConnected||document.hidden)return!1;const t=this.getBoundingClientRect(),s=10;return t.top>=-s&&t.bottom<=window.innerHeight+s&&t.left>=-s&&t.right<=window.innerWidth+s},y=function(){e(this,g)&&(cancelIdleCallback(e(this,g)),n(this,g,void 0)),e(this,f)&&(cancelAnimationFrame(e(this,f)),n(this,f,void 0))},$=function(t){t!==e(this,A)&&(n(this,A,t),t&&!this.hasAttribute("truncated")?this.setAttribute("truncated",""):this.hasAttribute("truncated")&&this.removeAttribute("truncated"))},O=function(){e(this,f)&&(cancelAnimationFrame(e(this,f)),n(this,f,void 0));const t=d=>this.innerText!==d?(this.innerText=d??"",!0):!1;n(this,f,requestAnimationFrame(()=>{var d;if(this&&(!this.isConnected||this.hasAttribute("disabled")))t(this.title);else{if(!e(this,h,N))return;const u=!this.title||!((d=e(this,o))!=null&&d.length);if(l(this,h,$).call(this,e(this,c).elLen<e(this,c).maxTextLen),u||!e(this,c).elLen||!this.truncated){t(this.title);return}if(e(this,c).elLen<=e(this,c).dividerLen){t(this.divider);return}const b=Math.floor(e(this,c).elLen-e(this,c).dividerLen),S=Math.floor(b*(this.at/100)),F=Math.floor(b-S),R=e(this,o).filter(({length:I},T,H)=>Math.ceil(H.slice(0,T).reduce((W,D)=>W+D.length,0)+I)<S).length,z=e(this,o).filter(({length:I},T,H)=>Math.ceil(H.slice(-T).reduce((W,D)=>W+D.length,0)+I)>F).length,B=this.title.slice(0,R),P=this.title.slice(z);t(`${B}${this.divider}${P}`)}}))},M=function(){if(!this||e(this,g))return;const t=()=>{const s=this.innerText,{writingMode:d}=getComputedStyle(this),u=d.startsWith("vertical");n(this,E,u?"︙":"…"),this.innerText=this.divider;const{width:p,height:b}=this.getBoundingClientRect();e(this,c).dividerLen=Math.ceil(u?b:p);let S=0;e(this,o).forEach((z,B)=>{this.innerText=z.segment;const{width:P,height:I}=this.getBoundingClientRect(),T=Math.ceil(u?I:P);S+=T,e(this,o)[B].length=T}),e(this,c).maxTextLen=S,this.innerText=this.title;const{width:F,height:R}=this.getBoundingClientRect();e(this,c).elLen=Math.floor(u?R:F),this.innerText=s,n(this,g,void 0)};n(this,g,requestIdleCallback(t,{timeout:this.ms}))};customElements.define("middle-truncate",j);
//# sourceMappingURL=index-CJBEHObK.js.map
