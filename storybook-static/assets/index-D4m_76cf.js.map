{"version":3,"file":"index-D4m_76cf.js","sources":["../../packages/middle-truncate/index.ts"],"sourcesContent":["type SegmentDataWithLength = Intl.SegmentData & {\r\n    length: number;\r\n};\r\n\r\nclass DimensionProxy {\r\n    #elLen: number;\r\n    #dividerLen: number;\r\n    #maxTextLen: number;\r\n    #maxChLen: number;\r\n    #onChange: (object: DimensionProxy) => void;\r\n    constructor(onChange: (object: DimensionProxy) => void, initialValue?: object) {\r\n        const { elLen = 0, dividerLen = 0, maxTextLen = 0, maxChLen = 0 } = (initialValue as DimensionProxy) ?? {};\r\n        this.#elLen = elLen;\r\n        this.#dividerLen = dividerLen;\r\n        this.#maxTextLen = maxTextLen;\r\n        this.#maxChLen = maxChLen;\r\n        this.#onChange = onChange;\r\n    }\r\n    get elLen(): number {\r\n        return this.#elLen;\r\n    };\r\n    set elLen(val: number) {\r\n        if (val !== this.#elLen) {\r\n            this.#elLen = val;\r\n            this.#onChange(this);\r\n        }\r\n    }\r\n    get dividerLen() {\r\n        return this.#dividerLen;\r\n    }\r\n    set dividerLen(val) {\r\n        if (val !== this.#dividerLen) {\r\n            this.#dividerLen = val;\r\n            this.#onChange(this);\r\n        }\r\n    }\r\n    get maxTextLen() {\r\n        return this.#maxTextLen;\r\n    }\r\n    set maxTextLen(val) {\r\n        if (val !== this.#maxTextLen) {\r\n            this.#maxTextLen = val;\r\n            this.#onChange(this);\r\n        }\r\n    }\r\n    get maxChLen() {\r\n        return this.#maxChLen;\r\n    }\r\n    set maxChLen(val) {\r\n        if (val !== this.#maxChLen) {\r\n            this.#maxChLen = val;\r\n            this.#onChange(this);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * A custom HTML element that truncates text in the middle to fit within a specified limit.\r\n * @module middle-truncate\r\n * @class MiddleTruncate\r\n * @extends HTMLElement\r\n * \r\n * @attribute {string} value - The text content to be truncated.\r\n * @attribute {number} limit - The maximum number of characters to display.\r\n * @attribute {string} dir - The text direction, either 'ltr' (left-to-right) or 'rtl' (right-to-left).\r\n * \r\n */\r\nclass MiddleTruncate extends HTMLElement {\r\n    #segmenter: Intl.Segmenter;\r\n    #segments: SegmentDataWithLength[] = [];\r\n    #dimensionUpdateLockId: ReturnType<typeof requestIdleCallback> | undefined;\r\n    #redrawLock: ReturnType<typeof requestAnimationFrame> | undefined;\r\n    #defaultDivider: string = 'â€¦';\r\n    #windowFocused = true;\r\n    #resizeObserver: ResizeObserver | undefined;\r\n    #dimensions: DimensionProxy;\r\n    #internals: ElementInternals;\r\n\r\n    static get observedAttributes() {\r\n        return ['title', 'at', 'divider', 'disabled', 'ms', 'truncated'];\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        window.addEventListener(\"resize\", () => {\r\n            this.#render();\r\n        });\r\n        window.addEventListener(\"focus\", () => {\r\n            this.#windowFocused = true;\r\n            this.#render();\r\n        });\r\n        window.addEventListener(\"blur\", () => {\r\n            this.#windowFocused = false;\r\n            this.#cancelNextRender();\r\n        });\r\n        document.addEventListener(\"visibilitychange\", () => {\r\n            if (document.hidden) {\r\n                this.#cancelNextRender();\r\n            } else {\r\n                this.#render();\r\n            }\r\n        });\r\n        this.#dimensions = new DimensionProxy((_dimProxy) => {\r\n            this.#redraw();\r\n        });\r\n\r\n        // Attach an ElementInternals to get states property\r\n        this.#internals = this.attachInternals();\r\n    }\r\n\r\n    get #canUpdate() {\r\n        if (!this || !this.#windowFocused || !this.isConnected || document.hidden) return false;\r\n        const rect = this.getBoundingClientRect();\r\n        //this isVisible check has a pixel buffer around the screen size\r\n        const bufferPx = 10;\r\n        const isVisible = rect.top >= -bufferPx && rect.bottom <= window.innerHeight + bufferPx && rect.left >= -bufferPx && rect.right <= window.innerWidth + bufferPx;\r\n        return isVisible;\r\n    }\r\n\r\n    #cancelNextRender() {\r\n        if (this.#dimensionUpdateLockId) {\r\n            cancelIdleCallback(this.#dimensionUpdateLockId);\r\n            this.#dimensionUpdateLockId = undefined;\r\n        }\r\n        if (this.#redrawLock) {\r\n            cancelAnimationFrame(this.#redrawLock);\r\n            this.#redrawLock = undefined;\r\n        }\r\n    }\r\n\r\n    connectedCallback() {\r\n        if (!this.#resizeObserver) {\r\n            this.#resizeObserver = new ResizeObserver((entries) => {\r\n                const { contentBoxSize } = entries[0];\r\n                const { inlineSize } = contentBoxSize[0];\r\n                if (inlineSize) {\r\n                    this.#dimensions.elLen = inlineSize;\r\n                }\r\n            });\r\n        }\r\n        this.#resizeObserver.observe(this);\r\n        this.#render();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.#cancelNextRender();\r\n        if (this.#resizeObserver) {\r\n            this.#resizeObserver.disconnect();\r\n        }\r\n    }\r\n\r\n    attributeChangedCallback(attrName, _oldVal, newVal) {\r\n        if (attrName === 'title') {\r\n            this.ariaLabel = newVal;\r\n            if (!this.#segmenter) {\r\n                this.#segmenter = new Intl.Segmenter();\r\n            }\r\n            if (!newVal) {\r\n                this.#segments = [];\r\n            } else {\r\n                Array.from(this.#segmenter.segment(newVal)).forEach((segData, idx) => {\r\n                    this.#segments[idx] = {\r\n                        ...segData,\r\n                        input: '', //the input is stored in this.title. No need to duplicate it in memory here\r\n                        length: this.#segments[idx]?.length ?? 0\r\n                    };\r\n                });\r\n            }\r\n        }\r\n        // 'truncated' is read-only and should always match the internal value\r\n        if (attrName === 'truncated') {\r\n            this.#setTruncated(this.truncated);\r\n        }\r\n        this.#render();\r\n    }\r\n\r\n    /**\r\n     * The percentage of text to show the truncation at.\r\n     */\r\n    get at(): number {\r\n        const fallback = 50;\r\n        if (this.hasAttribute('at')) {\r\n            try {\r\n                return parseInt(String(this.getAttribute('at')));\r\n            } catch (e) {\r\n                return fallback;\r\n            }\r\n        }\r\n        return fallback;\r\n    }\r\n\r\n    /**\r\n     * The percentage of text to show the truncation at.\r\n     */\r\n    set at(val: string | number | undefined | null) {\r\n        if (val === undefined || val === null) {\r\n            this.removeAttribute('at');\r\n        } else {\r\n            const asNum = Math.max(0, Math.min(100, parseInt(String(val))));\r\n            if (asNum) {\r\n                this.setAttribute('at', String(asNum));\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n * The maximum number of milliseconds to wait before recalculating dimensions\r\n */\r\n    get ms(): number {\r\n        const fallback = 16; //at 60fps 16ms is roughly 1 frame\r\n        if (this.hasAttribute('at')) {\r\n            try {\r\n                return parseInt(String(this.getAttribute('at')));\r\n            } catch (e) {\r\n                return fallback;\r\n            }\r\n        }\r\n        return fallback;\r\n    }\r\n\r\n    /**\r\n     * The maximum number of milliseconds to wait before recalculating dimensions\r\n     */\r\n    set ms(val: string | number | undefined | null) {\r\n        if (!val) {\r\n            this.removeAttribute('ms');\r\n        } else {\r\n            const asNum = Math.max(0, parseInt(String(val)));\r\n            if (asNum) {\r\n                this.setAttribute('ms', String(asNum));\r\n            }\r\n        }\r\n    }\r\n\r\n    get divider() {\r\n        return this.getAttribute('divider') ?? this.#defaultDivider;\r\n    }\r\n\r\n    set divider(val) {\r\n        if (!val?.length) {\r\n            this.removeAttribute('divider');\r\n        } else {\r\n            this.setAttribute('divider', val);\r\n        }\r\n    }\r\n\r\n    get truncated() {\r\n        return this.#internals.states.has('truncated');\r\n    }\r\n\r\n    #setTruncated(isTruncated: boolean) {\r\n        const hasInternal = this.#internals.states.has('truncated');\r\n        const hasAttr = this.hasAttribute('truncated');\r\n        if (isTruncated && !hasInternal) {\r\n            this.#internals.states.add('truncated');\r\n        } else {\r\n            this.#internals.states.delete('truncated');\r\n        }\r\n        if (isTruncated && !hasAttr) {\r\n            this.setAttribute('truncated', '');\r\n        } else if (this.hasAttribute('truncated')) {\r\n            this.removeAttribute('truncated');\r\n        }\r\n    }\r\n\r\n    #redraw() {\r\n        //this is the latest update, it's the only one that should be applied.\r\n        if (this.#redrawLock) {\r\n            cancelAnimationFrame(this.#redrawLock);\r\n            this.#redrawLock = undefined;\r\n        }\r\n        const updateInnerText = (newText: string): boolean => {\r\n            if (this.innerText !== newText) {\r\n                this.innerText = newText ?? '';\r\n                return true;\r\n            };\r\n            return false;\r\n        };\r\n        const redraw = () => {\r\n            if (this && (!this.isConnected || this.hasAttribute('disabled'))) {\r\n                updateInnerText(this.title);\r\n            } else {\r\n                //there's no point rendering elements that aren't seen, so only continue while the element is in view\r\n                if (!this.#canUpdate) return;\r\n                const noTitle = !this.title || !this.#segments?.length;\r\n                this.#setTruncated(this.#dimensions.elLen < this.#dimensions.maxTextLen);\r\n                const useFullText = noTitle || !this.#dimensions.elLen || !this.truncated;\r\n                if (useFullText) {\r\n                    updateInnerText(this.title);\r\n                    return;\r\n                }\r\n                //if the text is too small to display  anything more than the divider\r\n                if (this.#dimensions.elLen <= this.#dimensions.dividerLen) {\r\n                    updateInnerText(this.divider);\r\n                    return;\r\n                }\r\n                const availableSpace = Math.floor(this.#dimensions.elLen - this.#dimensions.dividerLen - this.#dimensions.maxChLen);\r\n                const startMaxPx = Math.floor(availableSpace * (this.at / 100));\r\n                const endMaxPx = Math.floor(availableSpace - startMaxPx);\r\n                const startIdx = this.#segments.filter(({ length: segLen }, idx, arr) => {\r\n                    const sumLen = Math.ceil(arr.slice(0, idx).reduce((prev, curr) => prev + curr.length, 0) + segLen);\r\n                    return sumLen < startMaxPx;\r\n                }).length;\r\n                const endIdx = this.#segments.filter(({ length: segLen }, idx, arr) => {\r\n                    const sumLen = Math.ceil(arr.slice(-idx).reduce((prev, curr) => prev + curr.length, 0) + segLen);\r\n                    return sumLen > endMaxPx;\r\n                }).length;\r\n                const startStr = this.title.slice(0, startIdx);\r\n                const endStr = this.title.slice(endIdx);\r\n                updateInnerText(`${startStr}${this.divider}${endStr}`);\r\n            };\r\n        }\r\n        this.#redrawLock = requestAnimationFrame(redraw);\r\n    }\r\n\r\n    #render() {\r\n        if (!this) return;\r\n        //there's an update pending, let it finish\r\n        if (this.#dimensionUpdateLockId) return;\r\n        const updateDimensions = () => {\r\n            const currentText = this.innerText;\r\n            const { writingMode } = getComputedStyle(this);\r\n            const isVertical = writingMode.startsWith('vertical');\r\n            const isSideways = writingMode.startsWith('sideways');\r\n            const useHeight = isVertical || isSideways;\r\n\r\n            const getDim = () => {\r\n                const { width, height } = this.getBoundingClientRect();\r\n                return useHeight ? height : width;\r\n            };\r\n\r\n            this.#defaultDivider = isVertical ? 'ï¸™' : 'â€¦'; //unicode FE19 and 2026\r\n            this.innerText = this.divider;\r\n            // const { width: dividerWidth, height: dividerHeight } = this.getBoundingClientRect();\r\n            this.#dimensions.dividerLen = Math.ceil(getDim());\r\n\r\n            //determine the dimensions of the text by summing the length and width of each rendered segment\r\n            let fullTextLen = 0;\r\n            this.#segments.forEach((segData, idx) => {\r\n                this.innerText = segData.segment;\r\n                const dim = Math.ceil(getDim());\r\n                fullTextLen += dim;\r\n                this.#segments[idx].length = dim;\r\n                this.#dimensions.maxChLen = Math.max(dim, this.#dimensions.maxChLen);\r\n            });\r\n            this.#dimensions.maxTextLen = fullTextLen;\r\n\r\n            this.innerText = this.title;\r\n            //determine the correct element dimensions to use for the next render\r\n            this.#dimensions.elLen = Math.floor(getDim());\r\n\r\n            //then restore the correct text\r\n            this.innerText = currentText;\r\n            // and remove the lock on updating dimensions\r\n            this.#dimensionUpdateLockId = undefined;\r\n        };\r\n        this.#dimensionUpdateLockId = requestIdleCallback(updateDimensions, { timeout: this.ms });\r\n    }\r\n}\r\n\r\ncustomElements.define('middle-truncate', MiddleTruncate);"],"names":["_elLen","_dividerLen","_maxTextLen","_maxChLen","_onChange","DimensionProxy","onChange","initialValue","__privateAdd","elLen","dividerLen","maxTextLen","maxChLen","__privateSet","__privateGet","val","_segmenter","_segments","_dimensionUpdateLockId","_redrawLock","_defaultDivider","_windowFocused","_resizeObserver","_dimensions","_internals","_MiddleTruncate_instances","canUpdate_get","cancelNextRender_fn","setTruncated_fn","redraw_fn","render_fn","MiddleTruncate","__privateMethod","_dimProxy","entries","contentBoxSize","inlineSize","attrName","_oldVal","newVal","segData","idx","_a","asNum","rect","bufferPx","isTruncated","hasInternal","hasAttr","updateInnerText","newText","noTitle","availableSpace","startMaxPx","endMaxPx","startIdx","segLen","arr","prev","curr","endIdx","startStr","endStr","updateDimensions","currentText","writingMode","isVertical","isSideways","useHeight","getDim","width","height","fullTextLen","dim"],"mappings":"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"}