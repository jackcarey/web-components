var q=r=>{throw TypeError(r)};var W=(r,i,e)=>i.has(r)||q("Cannot "+e);var t=(r,i,e)=>(W(r,i,"read from private field"),e?e.call(r):i.get(r)),c=(r,i,e)=>i.has(r)?q("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(r):i.set(r,e),s=(r,i,e,n)=>(W(r,i,"write to private field"),n?n.call(r,e):i.set(r,e),e),l=(r,i,e)=>(W(r,i,"access private method"),e);var v,w,A,T,g;class j{constructor(i,e){c(this,v);c(this,w);c(this,A);c(this,T);c(this,g);const{elLen:n=0,dividerLen:d=0,maxTextLen:f=0,maxChLen:b=0}=e??{};s(this,v,n),s(this,w,d),s(this,A,f),s(this,T,b),s(this,g,i)}get elLen(){return t(this,v)}set elLen(i){i!==t(this,v)&&(s(this,v,i),t(this,g).call(this,this))}get dividerLen(){return t(this,w)}set dividerLen(i){i!==t(this,w)&&(s(this,w,i),t(this,g).call(this,this))}get maxTextLen(){return t(this,A)}set maxTextLen(i){i!==t(this,A)&&(s(this,A,i),t(this,g).call(this,this))}get maxChLen(){return t(this,T)}set maxChLen(i){i!==t(this,T)&&(s(this,T,i),t(this,g).call(this,this))}}v=new WeakMap,w=new WeakMap,A=new WeakMap,T=new WeakMap,g=new WeakMap;var k,o,m,u,C,F,p,x,a,h,N,P,$,O,S;class G extends HTMLElement{constructor(){super();c(this,h);c(this,k);c(this,o,[]);c(this,m);c(this,u);c(this,C,!1);c(this,F,"…");c(this,p,!0);c(this,x);c(this,a);window.addEventListener("resize",()=>{l(this,h,S).call(this)}),window.addEventListener("focus",()=>{s(this,p,!0),l(this,h,S).call(this)}),window.addEventListener("blur",()=>{s(this,p,!1),l(this,h,P).call(this)}),document.addEventListener("visibilitychange",()=>{document.hidden?l(this,h,P).call(this):l(this,h,S).call(this)}),s(this,a,new j(e=>{l(this,h,O).call(this)}))}static get observedAttributes(){return["title","at","divider","disabled","ms","truncated"]}connectedCallback(){t(this,x)||s(this,x,new ResizeObserver(e=>{const{contentBoxSize:n}=e[0],{inlineSize:d}=n[0];d&&(t(this,a).elLen=d)})),t(this,x).observe(this),l(this,h,S).call(this)}disconnectedCallback(){l(this,h,P).call(this),t(this,x)&&t(this,x).disconnect()}attributeChangedCallback(e,n,d){e==="title"&&(t(this,k)||s(this,k,new Intl.Segmenter),d?Array.from(t(this,k).segment(d)).forEach((f,b)=>{var L;t(this,o)[b]={...f,input:"",length:((L=t(this,o)[b])==null?void 0:L.length)??0}}):s(this,o,[])),e==="truncated"&&l(this,h,$).call(this,t(this,C)),l(this,h,S).call(this)}get at(){if(this.hasAttribute("at"))try{return parseInt(String(this.getAttribute("at")))}catch{return 50}return 50}set at(e){if(e==null)this.removeAttribute("at");else{const n=Math.max(0,Math.min(100,parseInt(String(e))));n&&this.setAttribute("at",String(n))}}get ms(){if(this.hasAttribute("at"))try{return parseInt(String(this.getAttribute("at")))}catch{return 16}return 16}set ms(e){if(!e)this.removeAttribute("ms");else{const n=Math.max(0,parseInt(String(e)));n&&this.setAttribute("ms",String(n))}}get divider(){return this.getAttribute("divider")??t(this,F)}set divider(e){e!=null&&e.length?this.setAttribute("divider",e):this.removeAttribute("divider")}get truncated(){return t(this,C)}}k=new WeakMap,o=new WeakMap,m=new WeakMap,u=new WeakMap,C=new WeakMap,F=new WeakMap,p=new WeakMap,x=new WeakMap,a=new WeakMap,h=new WeakSet,N=function(){if(!this||!t(this,p)||!this.isConnected||document.hidden)return!1;const e=this.getBoundingClientRect(),n=10;return e.top>=-n&&e.bottom<=window.innerHeight+n&&e.left>=-n&&e.right<=window.innerWidth+n},P=function(){t(this,m)&&(cancelIdleCallback(t(this,m)),s(this,m,void 0)),t(this,u)&&(cancelAnimationFrame(t(this,u)),s(this,u,void 0))},$=function(e){e!==t(this,C)&&(s(this,C,e),e&&!this.hasAttribute("truncated")?this.setAttribute("truncated",""):this.hasAttribute("truncated")&&this.removeAttribute("truncated"))},O=function(){t(this,u)&&(cancelAnimationFrame(t(this,u)),s(this,u,void 0));const e=d=>this.innerText!==d?(this.innerText=d??"",!0):!1;s(this,u,requestAnimationFrame(()=>{var d;if(this&&(!this.isConnected||this.hasAttribute("disabled")))e(this.title);else{if(!t(this,h,N))return;const f=!this.title||!((d=t(this,o))!=null&&d.length);if(l(this,h,$).call(this,t(this,a).elLen<t(this,a).maxTextLen),f||!t(this,a).elLen||!this.truncated){e(this.title);return}if(t(this,a).elLen<=t(this,a).dividerLen){e(this.divider);return}const L=Math.floor(t(this,a).elLen-t(this,a).dividerLen-t(this,a).maxChLen),M=Math.floor(L*(this.at/100)),z=Math.floor(L-M),I=t(this,o).filter(({length:D},R,B)=>Math.ceil(B.slice(0,R).reduce((H,V)=>H+V.length,0)+D)<M).length,y=t(this,o).filter(({length:D},R,B)=>Math.ceil(B.slice(-R).reduce((H,V)=>H+V.length,0)+D)>z).length,E=this.title.slice(0,I),U=this.title.slice(y);e(`${E}${this.divider}${U}`)}}))},S=function(){if(!this||t(this,m))return;const e=()=>{const n=this.innerText,{writingMode:d}=getComputedStyle(this),f=d.startsWith("vertical"),b=d.startsWith("sideways"),L=f||b,M=()=>{const{width:I,height:y}=this.getBoundingClientRect();return L?y:I};s(this,F,f?"︙":"…"),this.innerText=this.divider,t(this,a).dividerLen=Math.ceil(M());let z=0;t(this,o).forEach((I,y)=>{this.innerText=I.segment;const E=Math.ceil(M());z+=E,t(this,o)[y].length=E,t(this,a).maxChLen=Math.max(E,t(this,a).maxChLen)}),t(this,a).maxTextLen=z,this.innerText=this.title,t(this,a).elLen=Math.floor(M()),this.innerText=n,s(this,m,void 0)};s(this,m,requestIdleCallback(e,{timeout:this.ms}))};customElements.define("middle-truncate",G);
//# sourceMappingURL=index-AQjbhjx3.js.map
